--=================================================================================--
-- S1.1 - Scoring Reports
--=================================================================================--
-- Portfolio report for input file and run IDs.
CREATE OR REPLACE FORCE VIEW "SCR_PORTFOLIO_REPORT" AS
SELECT      /*+ PARALLEL(8)*/
            STG.RUN_DATE AS RUN_DATE, 
            STG.RUN_ID AS RUN_ID, 
            CASE WHEN NVL(B_RESULT.REQUEST_ID,0) = 0 THEN A_RESULT.REQUEST_ID ELSE B_RESULT.REQUEST_ID END AS REQUEST_ID, 
            STG.CUSTOMER_CODE AS CUSTOMER_CODE,
            STG.CONTRACT_NUMBER AS CONTRACT_NUMBER, 
            CASE WHEN NVL(B_RESULT.REQUEST_ID,0) = 0 THEN A_RESULT.LEVEL_1 ELSE B_RESULT.LEVEL_1 END AS LEVEL_1, 
            CASE WHEN NVL(B_RESULT.REQUEST_ID,0) = 0 THEN A_RESULT.LEVEL_2 ELSE B_RESULT.LEVEL_2 END AS LEVEL_2, 
            STG.OPEN_DATE AS OPEN_DATE, 
            STG.DPD AS DPD, 
            STG.SUB AS SUB, 
            MONTHS_BETWEEN(TO_DATE(TO_CHAR(STG.RUN_DATE,'YYYYMM'),'YYYYMM'),TO_DATE(TO_CHAR(STG.OPEN_DATE,'YYYYMM'),'YYYYMM')) AS MOB,
            STG.PRIN_OUT_STD_BAL AS PRIN_OUT_STD_BAL, 
            B_RESULT.B_PD_ESTIMATE AS B_PD_ESTIMATE,
            B_RESULT.B_RATING_GRADE AS B_RATING_GRADE,
            B_RESULT.B_SCORE_POINTS AS B_SCORE_POINTS,
            A_RESULT.A_PD_ESTIMATE AS A_PD_ESTIMATE,
            A_RESULT.A_RATING_GRADE AS A_RATING_GRADE,
            A_RESULT.A_SCORE_POINTS AS A_SCORE_POINTS,
            CASE WHEN NVL(B_RESULT.REQUEST_ID,0) = 0 THEN A_RESULT.A_PD_ESTIMATE ELSE B_RESULT.B_PD_ESTIMATE END AS C_PD_ESTIMATE,
            CASE WHEN NVL(B_RESULT.REQUEST_ID,0) = 0 THEN A_RESULT.A_RATING_GRADE ELSE B_RESULT.B_RATING_GRADE END AS C_RATING_GRADE,
            CASE WHEN NVL(B_RESULT.REQUEST_ID,0) = 0 THEN A_RESULT.A_SCORE_POINTS ELSE B_RESULT.B_SCORE_POINTS END AS C_SCORE_POINTS,
            CASE WHEN NVL(B_RESULT.REQUEST_ID,0) = 0 THEN A_RESULT.A_RATING_GRADE ELSE B_RESULT.B_RATING_GRADE END AS FF_RATING_GRADE
FROM        (SELECT     STG.RUN_DATE AS RUN_DATE, 
                        STG.RUN_ID AS RUN_ID, 
                        STG.CIC AS CUSTOMER_CODE,
                        STG.CONTRACT_NUMBER AS CONTRACT_NUMBER,
                        PRD.PRODUCT_TYPE AS LEVEL_1,
                        ST.CUSTOMER_SEGMENT AS LEVEL_2,
                        STG.OPEN_DATE AS OPEN_DATE, 
                        STG.DELINQ_DAYS_M0 DPD,
                        STG.SUB_CODE AS SUB, 
                        STG.OUTSTANDING_AMOUNT_M0 AS PRIN_OUT_STD_BAL
            FROM        STG_SCORE_REQUEST_HIST STG, PRODUCT PRD, ST_MAPPING ST
            WHERE       STG.PRODUCT_CODE = PRD.PRODUCT_CODE
            AND         STG.PRODUCT_CODE = ST.PRODUCT_CODE
            AND         CASE WHEN STG.SALARY_TRANSFER IN (SELECT DISTINCT SALATRY_TRANSFER_TYPE_CTF FROM ST_MAPPING WHERE SALATRY_TRANSFER_TYPE_CTF <> 'Others') THEN SALARY_TRANSFER ELSE 'Others' END = ST.SALATRY_TRANSFER_TYPE_CTF) STG
LEFT JOIN   (SELECT     A_REQ.CONT_RUN_DATE AS RUN_DATE,
                        A_REQ.RUN_ID AS RUN_ID,
                        A_REQ.REQUEST_ID AS REQUEST_ID,
                        A_REQ.CONT_CIC AS CUSTOMER_CODE,
                        A_REQ.CONT_CONTRACT_NUMBER AS CONTRACT_NUMBER,
                        A_REQ.CONT_PRODUCT_TYPE AS LEVEL_1,
                        A_REQ.CONT_CUSTOMER_SEGMENT AS LEVEL_2,
                        A_REQ.CONT_DELINQ_DAYS AS DPD,
                        A_RES.A_SCOR_PD_ESTIMATE AS A_PD_ESTIMATE,
                        RIS.RISK_RATING_ID AS A_RATING_GRADE,
                        A_RES.A_SCOR_SCORE AS A_SCORE_POINTS
            FROM        A_SCORE_REQUEST_HIST A_REQ, A_SCORE_RESPONSE A_RES, RISK_RATING RIS
            WHERE       A_REQ.RUN_ID = A_RES.RUN_ID
            AND         A_REQ.REQUEST_ID = A_RES.REQUEST_ID
            AND         A_RES.A_SCOR_RISK_RATING = RIS.RISK_RATING
            ORDER BY    A_REQ.RUN_ID DESC, A_REQ.REQUEST_ID DESC) A_RESULT ON (STG.RUN_ID = A_RESULT.RUN_ID AND STG.CONTRACT_NUMBER = A_RESULT.CONTRACT_NUMBER)
LEFT JOIN   (SELECT     B_REQ.SCOR_PORTFOLIO_DATE AS RUN_DATE,
                        B_REQ.RUN_ID AS RUN_ID,
                        B_REQ.REQUEST_ID AS REQUEST_ID,
                        B_REQ.SCOR_CIC AS CUSTOMER_CODE,            
                        B_REQ.PROD_PRODUCT_TYPE AS LEVEL_1,
                        B_REQ.PROD_CUSTOMER_SEGMENT AS LEVEL_2,
                        B_REQ.PROD_DELINQ_DAYS_M0 AS DPD,
                        B_RES.B_SCOR_PD_ESTIMATE AS B_PD_ESTIMATE,
                        RIS.RISK_RATING_ID AS B_RATING_GRADE,
                        B_RES.B_SCOR_FINAL_SCORE_POINTS AS B_SCORE_POINTS
            FROM        B_SCORE_REQUEST_HIST B_REQ, B_SCORE_RESPONSE B_RES, RISK_RATING RIS
            WHERE       B_REQ.RUN_ID = B_RES.RUN_ID
            AND         B_REQ.REQUEST_ID = B_RES.REQUEST_ID
            AND         B_RES.B_SCOR_RISK_RATING = RIS.RISK_RATING
            ORDER BY    B_REQ.RUN_ID DESC, B_REQ.REQUEST_ID DESC) B_RESULT ON (STG.RUN_ID = B_RESULT.RUN_ID AND STG.CUSTOMER_CODE = B_RESULT.CUSTOMER_CODE AND STG.LEVEL_1 = B_RESULT.LEVEL_1 AND STG.LEVEL_2 = B_RESULT.LEVEL_2)
WHERE       CASE WHEN NVL(B_RESULT.REQUEST_ID,0) = 0 THEN A_RESULT.REQUEST_ID ELSE B_RESULT.REQUEST_ID END IS NOT NULL
ORDER BY    STG.RUN_ID DESC, CASE WHEN NVL(B_RESULT.REQUEST_ID,0) = 0 THEN A_RESULT.REQUEST_ID ELSE B_RESULT.REQUEST_ID END DESC;

-- Distribution Scorebands report (Sheet 1)
-- By principle outstanding balance
CREATE OR REPLACE FORCE VIEW "DIST_BY_SCOREBAND_BAL_REPORT" AS 
SELECT  RUN_DATE, RUN_ID, 
        (SELECT RIS.RISK_RATING FROM RISK_RATING RIS WHERE RIS.RISK_RATING_ID = FINAL_RESULT.RISK_RATING) RISK_RATING,
        SUM(WATANI) AS WATANI, 
        SUM(CAR_LEASING) AS CAR_LEASING, 
        SUM(REAL_ESTATE) AS REAL_ESTATE,
        SUM(REVOLVING_CARD) AS REVOLVING_CARD,
        SUM(TOTAL) AS TOTAL,     
        CASE WHEN RISK_RATING IN (1,2,3,4,5,6,7,8,9,10,11,12) THEN 'Low'
             WHEN RISK_RATING IN (13,14,15) THEN 'Medium'
             WHEN RISK_RATING IN (16,17,18,19) THEN 'High'
             ELSE 'None' END AS RISK_PROFILE
FROM (                     
    SELECT  RESULT.RUN_DATE, RESULT.RUN_ID, RESULT.RISK_RATING,
            NVL(MAX(DECODE(RESULT.PRODUCT_TYPE, 'Watani', CASE WHEN RESULT.TOTAL_SUM_RATING_PER_TYPE = 0 THEN 0 ELSE ROUND(RESULT.SUM_RATING/RESULT.TOTAL_SUM_RATING_PER_TYPE,8) END)),0) AS WATANI,
            NVL(MAX(DECODE(RESULT.PRODUCT_TYPE, 'Car Leasing', CASE WHEN RESULT.TOTAL_SUM_RATING_PER_TYPE = 0 THEN 0 ELSE ROUND(RESULT.SUM_RATING/RESULT.TOTAL_SUM_RATING_PER_TYPE,8) END)),0) AS CAR_LEASING,
            NVL(MAX(DECODE(RESULT.PRODUCT_TYPE, 'Real Estate', CASE WHEN RESULT.TOTAL_SUM_RATING_PER_TYPE = 0 THEN 0 ELSE ROUND(RESULT.SUM_RATING/RESULT.TOTAL_SUM_RATING_PER_TYPE,8) END)),0) AS REAL_ESTATE,
            NVL(MAX(DECODE(RESULT.PRODUCT_TYPE, 'Revolving_Card', CASE WHEN RESULT.TOTAL_SUM_RATING_PER_TYPE = 0 THEN 0 ELSE ROUND(RESULT.SUM_RATING/RESULT.TOTAL_SUM_RATING_PER_TYPE,8) END)),0) AS REVOLVING_CARD,
            NVL(MAX(CASE WHEN RESULT.TOTAL_SUM_RATING = 0 THEN 0 ELSE ROUND(RESULT.TOTAL_SUM_RATING_PER_RATING/RESULT.TOTAL_SUM_RATING,8) END),0) AS TOTAL
    FROM (
        SELECT      TEMP.RUN_DATE AS RUN_DATE, TEMP.RUN_ID, TEMP.FF_RATING_GRADE AS RISK_RATING,
                    TEMP.LEVEL_1 AS PRODUCT_TYPE, NVL(TEMP.BALANCE,0) AS SUM_RATING, 
                    NVL(SUM(TEMP.BALANCE) OVER (PARTITION BY TEMP.RUN_DATE, TEMP.RUN_ID, TEMP.LEVEL_1),0) TOTAL_SUM_RATING_PER_TYPE,
                    NVL(SUM(TEMP.BALANCE) OVER (PARTITION BY TEMP.RUN_DATE, TEMP.RUN_ID, TEMP.FF_RATING_GRADE),0) TOTAL_SUM_RATING_PER_RATING,
                    NVL(SUM(TEMP.BALANCE) OVER (PARTITION BY TEMP.RUN_DATE, TEMP.RUN_ID),0) TOTAL_SUM_RATING
        FROM (
                SELECT      SCR_PORT.RUN_DATE,
                            SCR_PORT.RUN_ID,
                            SCR_PORT.LEVEL_1,
                            SCR_PORT.FF_RATING_GRADE,
                            (SELECT RIS.RISK_RATING FROM RISK_RATING RIS WHERE RIS.RISK_RATING_ID = SCR_PORT.FF_RATING_GRADE) RISK_RATING,
                            SUM(SCR_PORT.PRIN_OUT_STD_BAL) BALANCE            
                FROM        SCR_PORTFOLIO_REPORT SCR_PORT
                WHERE       SCR_PORT.DPD < 90
                AND         SCR_PORT.SUB NOT IN (92,94,99)
                GROUP BY    SCR_PORT.RUN_DATE,
                            SCR_PORT.RUN_ID,
                            SCR_PORT.FF_RATING_GRADE,
                            SCR_PORT.LEVEL_1) TEMP) RESULT
    GROUP BY RESULT.RUN_DATE, RESULT.RUN_ID, RESULT.RISK_RATING, RESULT.RISK_RATING) FINAL_RESULT
GROUP BY RUN_DATE, RUN_ID, RISK_RATING    
ORDER BY RUN_ID DESC, FINAL_RESULT.RISK_RATING;

-- By number of contracts
CREATE OR REPLACE FORCE VIEW "DIST_BY_SCOREBAND_CONT_REPORT" AS 
SELECT  RUN_DATE, RUN_ID, 
        (SELECT RIS.RISK_RATING FROM RISK_RATING RIS WHERE RIS.RISK_RATING_ID = FINAL_RESULT.RISK_RATING) RISK_RATING,
        SUM(WATANI) AS WATANI, 
        SUM(CAR_LEASING) AS CAR_LEASING, 
        SUM(REAL_ESTATE) AS REAL_ESTATE,
        SUM(REVOLVING_CARD) AS REVOLVING_CARD, 
        SUM(TOTAL) AS TOTAL,         
        CASE WHEN RISK_RATING IN (1,2,3,4,5,6,7,8,9,10,11,12) THEN 'Low'
             WHEN RISK_RATING IN (13,14,15) THEN 'Medium'
             WHEN RISK_RATING IN (16,17,18,19) THEN 'High'
             ELSE 'None' END AS RISK_PROFILE
FROM (                     
    SELECT  RESULT.RUN_DATE, RESULT.RUN_ID, RESULT.RISK_RATING,
            NVL(MAX(DECODE(RESULT.PRODUCT_TYPE, 'Watani', CASE WHEN RESULT.TOTAL_SUM_RATING_PER_TYPE = 0 THEN 0 ELSE ROUND(RESULT.SUM_RATING/RESULT.TOTAL_SUM_RATING_PER_TYPE,8) END)),0) AS WATANI,
            NVL(MAX(DECODE(RESULT.PRODUCT_TYPE, 'Car Leasing', CASE WHEN RESULT.TOTAL_SUM_RATING_PER_TYPE = 0 THEN 0 ELSE ROUND(RESULT.SUM_RATING/RESULT.TOTAL_SUM_RATING_PER_TYPE,8) END)),0) AS CAR_LEASING,
            NVL(MAX(DECODE(RESULT.PRODUCT_TYPE, 'Real Estate', CASE WHEN RESULT.TOTAL_SUM_RATING_PER_TYPE = 0 THEN 0 ELSE ROUND(RESULT.SUM_RATING/RESULT.TOTAL_SUM_RATING_PER_TYPE,8) END)),0) AS REAL_ESTATE,
                        NVL(MAX(DECODE(RESULT.PRODUCT_TYPE, 'Revolving_Card', CASE WHEN RESULT.TOTAL_SUM_RATING_PER_TYPE = 0 THEN 0 ELSE ROUND(RESULT.SUM_RATING/RESULT.TOTAL_SUM_RATING_PER_TYPE,8) END)),0) AS REVOLVING_CARD,
            NVL(MAX(CASE WHEN RESULT.TOTAL_SUM_RATING = 0 THEN 0 ELSE ROUND(RESULT.TOTAL_SUM_RATING_PER_RATING/RESULT.TOTAL_SUM_RATING,8) END),0) AS TOTAL
    FROM (
        SELECT      TEMP.RUN_DATE AS RUN_DATE, TEMP.RUN_ID, TEMP.FF_RATING_GRADE AS RISK_RATING,
                    TEMP.LEVEL_1 AS PRODUCT_TYPE, NVL(TEMP.COUNT,0) AS SUM_RATING, 
                    NVL(SUM(TEMP.COUNT) OVER (PARTITION BY TEMP.RUN_DATE, TEMP.RUN_ID, TEMP.LEVEL_1),0) TOTAL_SUM_RATING_PER_TYPE,
                    NVL(SUM(TEMP.COUNT) OVER (PARTITION BY TEMP.RUN_DATE, TEMP.RUN_ID, TEMP.FF_RATING_GRADE),0) TOTAL_SUM_RATING_PER_RATING,
                    NVL(SUM(TEMP.COUNT) OVER (PARTITION BY TEMP.RUN_DATE, TEMP.RUN_ID),0) TOTAL_SUM_RATING
        FROM (
                SELECT      SCR_PORT.RUN_DATE,
                            SCR_PORT.RUN_ID,
                            SCR_PORT.LEVEL_1,
                            SCR_PORT.FF_RATING_GRADE,
                            (SELECT RIS.RISK_RATING FROM RISK_RATING RIS WHERE RIS.RISK_RATING_ID = SCR_PORT.FF_RATING_GRADE) RISK_RATING,
                            COUNT(SCR_PORT.CONTRACT_NUMBER) COUNT            
                FROM        SCR_PORTFOLIO_REPORT SCR_PORT
                WHERE       SCR_PORT.DPD < 90
                AND         SCR_PORT.SUB NOT IN (92,94,99)
                GROUP BY    SCR_PORT.RUN_DATE,
                            SCR_PORT.RUN_ID,
                            SCR_PORT.FF_RATING_GRADE,
                            SCR_PORT.LEVEL_1) TEMP) RESULT
    GROUP BY RESULT.RUN_DATE, RESULT.RUN_ID, RESULT.RISK_RATING, RESULT.RISK_RATING) FINAL_RESULT
GROUP BY RUN_DATE, RUN_ID, RISK_RATING    
ORDER BY RUN_ID DESC, FINAL_RESULT.RISK_RATING;

-- Risk Profile report (Sheet 4)
CREATE OR REPLACE FORCE VIEW "RISK_PROFILE_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            RUN_DATE, RUN_ID, PRODUCT_TYPE, RISK_PROFILE, BOOKING_MTH, BOOKING_QTR, COUNT
FROM (
    SELECT      TO_DATE(RES.SCORING_RUN_DATE,'YYYYMMDD') RUN_DATE,
                REQ.RUN_ID AS RUN_ID,
                REQ.CONT_PRODUCT_TYPE AS PRODUCT_TYPE,
                RES.A_SCOR_RISK_PROFILE AS RISK_PROFILE,
                TO_CHAR(REQ.CONT_OPEN_DATE,'YYYYMM') AS BOOKING_MTH,
                CASE    WHEN TO_CHAR(REQ.CONT_OPEN_DATE,'MM') IN ('01','02','03') THEN TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY')||'03' 
                        WHEN TO_CHAR(REQ.CONT_OPEN_DATE,'MM') IN ('04','05','06') THEN TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY')||'06' 
                        WHEN TO_CHAR(REQ.CONT_OPEN_DATE,'MM') IN ('07','08','09') THEN TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY')||'09' 
                        WHEN TO_CHAR(REQ.CONT_OPEN_DATE,'MM') IN ('10','11','12') THEN TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY')||'12' 
                        END AS BOOKING_QTR, 
                CASE    WHEN UPPER(RES.A_SCOR_RISK_PROFILE) = 'LOW' THEN 1 
                        WHEN UPPER(RES.A_SCOR_RISK_PROFILE) = 'MEDIUM' THEN 2 
                        WHEN UPPER(RES.A_SCOR_RISK_PROFILE) = 'HIGH' THEN 3 
                        END AS RISK_LEVEL,
                COUNT(REQ.CONT_CONTRACT_NUMBER) COUNT
    FROM        A_SCORE_REQUEST_HIST REQ, A_SCORE_RESPONSE RES, RISK_RATING RIS
    WHERE       REQ.CONT_CIC = RES.CIC
    AND         RIS.RISK_RATING = RES.A_SCOR_RISK_RATING
    AND         REQ.REQUEST_ID = RES.REQUEST_ID
    AND         REQ.CONT_RUN_DATE = TO_DATE(RES.SCORING_RUN_DATE,'YYYYMMDD')    
    GROUP BY    RES.SCORING_RUN_DATE, REQ.RUN_ID, REQ.CONT_PRODUCT_TYPE, RES.A_SCOR_RISK_PROFILE, TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY'), TO_CHAR(REQ.CONT_OPEN_DATE,'YYYYMM'), TO_CHAR(REQ.CONT_OPEN_DATE,'MM'))
ORDER BY    RUN_ID DESC, PRODUCT_TYPE, RISK_LEVEL, BOOKING_MTH;

-- NB_IRR report (Sheet 5)
CREATE OR REPLACE FORCE VIEW "NB_IRR_REPORT" AS 
SELECT  /*+ PARALLEL(8)*/
        RUN_DATE, RUN_ID, PRODUCT_TYPE, RISK_PROFILE, BOOKING_MTH, BOOKING_QTR, PRINCIPLE_OUTSTANDING_BAL, IRR_WGHT_EXP
FROM (
    SELECT      TO_DATE(RES.SCORING_RUN_DATE,'YYYYMMDD') RUN_DATE,
                REQ.RUN_ID AS RUN_ID,
                REQ.CONT_PRODUCT_TYPE AS PRODUCT_TYPE,
                RES.A_SCOR_RISK_PROFILE AS RISK_PROFILE,
                TO_CHAR(REQ.CONT_OPEN_DATE,'YYYYMM') AS BOOKING_MTH,
                CASE    WHEN TO_CHAR(REQ.CONT_OPEN_DATE,'MM') IN ('01','02','03') THEN TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY')||'03' 
                        WHEN TO_CHAR(REQ.CONT_OPEN_DATE,'MM') IN ('04','05','06') THEN TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY')||'06' 
                        WHEN TO_CHAR(REQ.CONT_OPEN_DATE,'MM') IN ('07','08','09') THEN TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY')||'09' 
                        WHEN TO_CHAR(REQ.CONT_OPEN_DATE,'MM') IN ('10','11','12') THEN TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY')||'12' 
                        END AS BOOKING_QTR, 
                CASE    WHEN UPPER(RES.A_SCOR_RISK_PROFILE) = 'LOW' THEN 1 
                        WHEN UPPER(RES.A_SCOR_RISK_PROFILE) = 'MEDIUM' THEN 2 
                        WHEN UPPER(RES.A_SCOR_RISK_PROFILE) = 'HIGH' THEN 3 
                        END AS RISK_LEVEL,
                SUM(REQ.CONT_PRINCIPAL_OUTSTANDING) PRINCIPLE_OUTSTANDING_BAL,
                SUM(REQ.CASA_AVERAGE_BAL_MONTH_M0*REQ.CONT_ADD_RATE) IRR_WGHT_EXP
    FROM        A_SCORE_REQUEST_HIST REQ, A_SCORE_RESPONSE RES, RISK_RATING RIS
    WHERE       REQ.CONT_CIC = RES.CIC
    AND         RIS.RISK_RATING = RES.A_SCOR_RISK_RATING
    AND         REQ.REQUEST_ID = RES.REQUEST_ID
    AND         REQ.CONT_RUN_DATE = TO_DATE(RES.SCORING_RUN_DATE,'YYYYMMDD')
    GROUP BY    RES.SCORING_RUN_DATE, REQ.RUN_ID, REQ.CONT_PRODUCT_TYPE, RES.A_SCOR_RISK_PROFILE, TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY'), TO_CHAR(REQ.CONT_OPEN_DATE,'YYYYMM'), TO_CHAR(REQ.CONT_OPEN_DATE,'MM'))
    ORDER BY    RUN_ID DESC, PRODUCT_TYPE, RISK_LEVEL, BOOKING_MTH;  

-- APP_RATING_SCR report (Sheet 6)
CREATE OR REPLACE FORCE VIEW "APP_RATING_SCR_REPORT" AS 
SELECT    /*+ PARALLEL(8)*/
            RUN_DATE, RUN_ID, PRODUCT_TYPE, CURRENT_MOB, BOOKING_MTH, A_RATING_GRADE, COUNT, BALANCE
FROM (
    SELECT      TO_DATE(RES.SCORING_RUN_DATE,'YYYYMMDD') RUN_DATE,
                REQ.RUN_ID,
                REQ.CONT_PRODUCT_TYPE AS PRODUCT_TYPE,
                RIS.RISK_RATING_ID AS A_RATING_GRADE,
                MONTHS_BETWEEN(TO_DATE(TO_CHAR(TO_DATE(RES.SCORING_RUN_DATE,'YYYYMMDD'),'YYYYMM'),'YYYYMM'),TO_DATE(TO_CHAR(REQ.CONT_OPEN_DATE,'YYYYMM'),'YYYYMM')) CURRENT_MOB,
                TO_CHAR(REQ.CONT_OPEN_DATE,'YYYYMM') AS BOOKING_MTH,
                COUNT(REQ.CONT_CONTRACT_NUMBER) COUNT,
                SUM(REQ.CASA_AVERAGE_BAL_MONTH_M0) BALANCE
    FROM        A_SCORE_REQUEST_HIST REQ, A_SCORE_RESPONSE RES, RISK_RATING RIS
    WHERE       REQ.CONT_CIC = RES.CIC
    AND         RIS.RISK_RATING = RES.A_SCOR_RISK_RATING
    AND         REQ.REQUEST_ID = RES.REQUEST_ID
    AND         REQ.CONT_RUN_DATE = TO_DATE(RES.SCORING_RUN_DATE,'YYYYMMDD')
    GROUP BY    RES.SCORING_RUN_DATE, REQ.RUN_ID, REQ.CONT_PRODUCT_TYPE, RIS.RISK_RATING_ID, TO_CHAR(REQ.CONT_OPEN_DATE,'YYYY'), TO_CHAR(REQ.CONT_OPEN_DATE,'YYYYMM'), TO_CHAR(REQ.CONT_OPEN_DATE,'MM'))
    ORDER BY    RUN_ID DESC, PRODUCT_TYPE, CURRENT_MOB, BOOKING_MTH, A_RATING_GRADE;    

-- PD & Exposure Product report (Sheet 2)
CREATE OR REPLACE FORCE VIEW "PD_EXPOSURE_PROD_TYPE_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            RUN_DATE,
            RUN_ID,
            LEVEL_1,
            ROUND(WGHT_APPLICATION_PD,8) AS WGHT_APP_PD,
            (SELECT RISK_RATING FROM RISK_RATING WHERE WGHT_APPLICATION_PD BETWEEN RISK_RATING_MIN_VAL AND RISK_RATING_MAX_VAL) AS APP_RISK_RATING,
            ROUND(WGHT_BEHAVIOR_PD,8) AS WGHT_BEH_PD,
            (SELECT RISK_RATING FROM RISK_RATING WHERE WGHT_BEHAVIOR_PD BETWEEN RISK_RATING_MIN_VAL AND RISK_RATING_MAX_VAL) AS BEH_RISK_RATING,
            ROUND(WGHT_CONSOLIDATED_PD,8) AS WGHT_CONS_PD,
            (SELECT RISK_RATING FROM RISK_RATING WHERE WGHT_CONSOLIDATED_PD BETWEEN RISK_RATING_MIN_VAL AND RISK_RATING_MAX_VAL) AS CONS_RISK_RATING,
            ENR_APP,
            ENR_BEH,
            ENR_CONS           
FROM (
    SELECT      RUN_DATE,
                RUN_ID,
                LEVEL_1,
                SUM(CASE    WHEN NVL(A_PD_ESTIMATE,0) <> 0 AND NVL(B_PD_ESTIMATE,0) = 0
                                THEN A_PD_ESTIMATE*PRIN_OUT_STD_BAL
                            ELSE
                                0 END)/
                CASE    WHEN SUM(CASE       WHEN NVL(A_PD_ESTIMATE,0) <> 0 AND NVL(B_PD_ESTIMATE,0) = 0
                                                THEN PRIN_OUT_STD_BAL
                                            ELSE 0 END) = 0 
                            THEN 1
                        ELSE SUM(CASE       WHEN NVL(A_PD_ESTIMATE,0) <> 0 AND NVL(B_PD_ESTIMATE,0) = 0
                                                THEN PRIN_OUT_STD_BAL
                                            ELSE 0 END) 
                        END AS WGHT_APPLICATION_PD,
                SUM(CASE    WHEN NVL(B_PD_ESTIMATE,0) <> 0
                                THEN B_PD_ESTIMATE*PRIN_OUT_STD_BAL
                            ELSE
                                0 END)/
                CASE    WHEN SUM(CASE       WHEN NVL(B_PD_ESTIMATE,0) <> 0
                                                THEN PRIN_OUT_STD_BAL
                                            ELSE 0 END) = 0
                            THEN 1
                        ELSE SUM(CASE       WHEN NVL(B_PD_ESTIMATE,0) <> 0
                                                THEN PRIN_OUT_STD_BAL
                                            ELSE 0 END)
                        END AS WGHT_BEHAVIOR_PD,
                SUM(CASE    WHEN NVL(B_PD_ESTIMATE,0) <> 0 AND DPD < 90
                                THEN B_PD_ESTIMATE*PRIN_OUT_STD_BAL
                            WHEN NVL(A_PD_ESTIMATE,0) <> 0 AND NVL(B_PD_ESTIMATE,0) = 0 AND DPD < 90
                                THEN A_PD_ESTIMATE*PRIN_OUT_STD_BAL
                            ELSE
                                0 END)/
                CASE    WHEN SUM(CASE       WHEN NVL(B_PD_ESTIMATE,0) <> 0 AND DPD < 90
                                                THEN PRIN_OUT_STD_BAL
                                            WHEN NVL(A_PD_ESTIMATE,0) <> 0 AND NVL(B_PD_ESTIMATE,0) = 0 AND DPD < 90
                                                THEN PRIN_OUT_STD_BAL
                                            ELSE 0 END) = 0 
                            THEN 1
                        ELSE SUM(CASE       WHEN NVL(B_PD_ESTIMATE,0) <> 0 AND DPD < 90
                                                THEN PRIN_OUT_STD_BAL
                                            WHEN NVL(A_PD_ESTIMATE,0) <> 0 AND NVL(B_PD_ESTIMATE,0) = 0 AND DPD < 90
                                                THEN PRIN_OUT_STD_BAL
                                            ELSE 0 END)
                        END AS WGHT_CONSOLIDATED_PD,
                SUM(CASE    WHEN NVL(A_PD_ESTIMATE,0) <> 0 AND NVL(B_PD_ESTIMATE,0) = 0
                                THEN PRIN_OUT_STD_BAL
                            ELSE
                                0 END) AS ENR_APP,
                SUM(CASE    WHEN NVL(B_PD_ESTIMATE,0) <> 0
                                THEN PRIN_OUT_STD_BAL
                            ELSE
                                0 END) AS ENR_BEH,
                SUM(CASE    WHEN NVL(B_PD_ESTIMATE,0) <> 0 AND DPD < 90
                                THEN PRIN_OUT_STD_BAL
                            WHEN NVL(A_PD_ESTIMATE,0) <> 0 AND NVL(B_PD_ESTIMATE,0) = 0 AND DPD < 90
                                THEN PRIN_OUT_STD_BAL
                            ELSE 0 END) AS ENR_CONS
    FROM        SCR_PORTFOLIO_REPORT
    WHERE       SUB NOT IN (92,94,99)
    GROUP BY    RUN_DATE,
                RUN_ID,
                LEVEL_1)
ORDER BY    RUN_ID DESC, LEVEL_1;  

-- Product Factor Analysis by Records & Exposure (A_Score)
CREATE OR REPLACE FORCE VIEW "PROD_FACTOR_A_SCORE_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            RUN_DATE, RUN_ID, PRODUCT_TYPE, CUSTOMER_SEGMENT, FACTOR, FACTOR_BIN, FACTOR_SCORE,
            NVL(MAX(DECODE(MONTHS_DIFF, 1, CIC_COUNT)),0) AS M_01_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 2, CIC_COUNT)),0) AS M_02_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 3, CIC_COUNT)),0) AS M_03_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 4, CIC_COUNT)),0) AS M_04_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 5, CIC_COUNT)),0) AS M_05_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 6, CIC_COUNT)),0) AS M_06_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 7, CIC_COUNT)),0) AS M_07_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 8, CIC_COUNT)),0) AS M_08_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 9, CIC_COUNT)),0) AS M_09_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 10, CIC_COUNT)),0) AS M_10_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 11, CIC_COUNT)),0) AS M_11_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 12, CIC_COUNT)),0) AS M_12_RECORDS,
            NVL(MAX(DECODE(MONTHS_DIFF, 1, SUM_OUTSTANDING_AMT)),0) AS M_01_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 2, SUM_OUTSTANDING_AMT)),0) AS M_02_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 3, SUM_OUTSTANDING_AMT)),0) AS M_03_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 4, SUM_OUTSTANDING_AMT)),0) AS M_04_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 5, SUM_OUTSTANDING_AMT)),0) AS M_05_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 6, SUM_OUTSTANDING_AMT)),0) AS M_06_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 7, SUM_OUTSTANDING_AMT)),0) AS M_07_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 8, SUM_OUTSTANDING_AMT)),0) AS M_08_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 9, SUM_OUTSTANDING_AMT)),0) AS M_09_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 10, SUM_OUTSTANDING_AMT)),0) AS M_10_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 11, SUM_OUTSTANDING_AMT)),0) AS M_11_EXPOSURE,
            NVL(MAX(DECODE(MONTHS_DIFF, 12, SUM_OUTSTANDING_AMT)),0) AS M_12_EXPOSURE            
FROM (
    SELECT              RUN_DATE RUN_DATE, RUN_ID RUN_ID, PRODUCT_TYPE PRODUCT_TYPE, CUSTOMER_SEGMENT CUSTOMER_SEGMENT, 
                        FACTOR, FACTOR_BIN, FACTOR_SCORE, SCORE_ELEMENT, COUNT(CIC) CIC_COUNT, SUM(OUTSTANDING_AMT) SUM_OUTSTANDING_AMT, MONTHS_DIFF
    FROM                (SELECT     A_REQ.CONT_RUN_DATE RUN_DATE, A_REQ.RUN_ID, A_REQ.CONT_CONTRACT_NUMBER CONTRACT_NUMBER, A_REQ.CONT_CIC CIC, A_REQ.CONT_PRINCIPAL_OUTSTANDING OUTSTANDING_AMT, 
                                    A_REQ.CONT_PRODUCT_TYPE PRODUCT_TYPE, A_REQ.CONT_CUSTOMER_SEGMENT CUSTOMER_SEGMENT, 
                                    A_RES.A_SCOR_ELEMENT_01,A_RES.A_SCOR_OUTCOME_01,A_RES.A_SCOR_SCORE_VALUE_01,
                                    A_RES.A_SCOR_ELEMENT_02,A_RES.A_SCOR_OUTCOME_02,A_RES.A_SCOR_SCORE_VALUE_02,
                                    A_RES.A_SCOR_ELEMENT_03,A_RES.A_SCOR_OUTCOME_03,A_RES.A_SCOR_SCORE_VALUE_03,
                                    A_RES.A_SCOR_ELEMENT_04,A_RES.A_SCOR_OUTCOME_04,A_RES.A_SCOR_SCORE_VALUE_04,
                                    A_RES.A_SCOR_ELEMENT_05,A_RES.A_SCOR_OUTCOME_05,A_RES.A_SCOR_SCORE_VALUE_05,
                                    A_RES.A_SCOR_ELEMENT_06,A_RES.A_SCOR_OUTCOME_06,A_RES.A_SCOR_SCORE_VALUE_06,
                                    A_RES.A_SCOR_ELEMENT_07,A_RES.A_SCOR_OUTCOME_07,A_RES.A_SCOR_SCORE_VALUE_07,
                                    A_RES.A_SCOR_ELEMENT_08,A_RES.A_SCOR_OUTCOME_08,A_RES.A_SCOR_SCORE_VALUE_08,
                                    A_RES.A_SCOR_ELEMENT_09,A_RES.A_SCOR_OUTCOME_09,A_RES.A_SCOR_SCORE_VALUE_09,
                                    A_RES.A_SCOR_ELEMENT_10,A_RES.A_SCOR_OUTCOME_10,A_RES.A_SCOR_SCORE_VALUE_10,
                                    A_RES.A_SCOR_ELEMENT_11,A_RES.A_SCOR_OUTCOME_11,A_RES.A_SCOR_SCORE_VALUE_11,
                                    A_RES.A_SCOR_ELEMENT_12,A_RES.A_SCOR_OUTCOME_12,A_RES.A_SCOR_SCORE_VALUE_12,
                                    A_RES.A_SCOR_ELEMENT_13,A_RES.A_SCOR_OUTCOME_13,A_RES.A_SCOR_SCORE_VALUE_13,
                                    A_RES.A_SCOR_ELEMENT_14,A_RES.A_SCOR_OUTCOME_14,A_RES.A_SCOR_SCORE_VALUE_14,
                                    A_RES.A_SCOR_ELEMENT_15,A_RES.A_SCOR_OUTCOME_15,A_RES.A_SCOR_SCORE_VALUE_15,
                                    A_RES.A_SCOR_ELEMENT_16,A_RES.A_SCOR_OUTCOME_16,A_RES.A_SCOR_SCORE_VALUE_16,
                                    A_RES.A_SCOR_ELEMENT_17,A_RES.A_SCOR_OUTCOME_17,A_RES.A_SCOR_SCORE_VALUE_17,
                                    A_RES.A_SCOR_ELEMENT_18,A_RES.A_SCOR_OUTCOME_18,A_RES.A_SCOR_SCORE_VALUE_18,
                                    A_RES.A_SCOR_ELEMENT_19,A_RES.A_SCOR_OUTCOME_19,A_RES.A_SCOR_SCORE_VALUE_19,
                                    A_RES.A_SCOR_ELEMENT_20,A_RES.A_SCOR_OUTCOME_20,A_RES.A_SCOR_SCORE_VALUE_20,
                                    MONTHS_BETWEEN(TO_DATE(TO_CHAR(TO_DATE(A_RES.SCORING_RUN_DATE,'YYYYMMDD'),'YYYYMM'),'YYYYMM'),TO_DATE(TO_CHAR(A_REQ.CONT_OPEN_DATE,'YYYYMM'),'YYYYMM')) MONTHS_DIFF
                        FROM        A_SCORE_REQUEST_HIST A_REQ, A_SCORE_RESPONSE A_RES
                        WHERE       A_REQ.REQUEST_ID = A_RES.REQUEST_ID
                        AND         A_REQ.CONT_RUN_DATE = TO_DATE(A_RES.SCORING_RUN_DATE,'YYYYMMDD'))
                        UNPIVOT(
                            (FACTOR, FACTOR_BIN, FACTOR_SCORE)
                            FOR     SCORE_ELEMENT IN
                                    ((A_SCOR_ELEMENT_01,A_SCOR_OUTCOME_01,A_SCOR_SCORE_VALUE_01) AS 'A_SCOR_ELEMENT_01',
                                    (A_SCOR_ELEMENT_02,A_SCOR_OUTCOME_02,A_SCOR_SCORE_VALUE_02) AS 'A_SCOR_ELEMENT_02',
                                    (A_SCOR_ELEMENT_03,A_SCOR_OUTCOME_03,A_SCOR_SCORE_VALUE_03) AS 'A_SCOR_ELEMENT_03',
                                    (A_SCOR_ELEMENT_04,A_SCOR_OUTCOME_04,A_SCOR_SCORE_VALUE_04) AS 'A_SCOR_ELEMENT_04',
                                    (A_SCOR_ELEMENT_05,A_SCOR_OUTCOME_05,A_SCOR_SCORE_VALUE_05) AS 'A_SCOR_ELEMENT_05',
                                    (A_SCOR_ELEMENT_06,A_SCOR_OUTCOME_06,A_SCOR_SCORE_VALUE_06) AS 'A_SCOR_ELEMENT_06',
                                    (A_SCOR_ELEMENT_07,A_SCOR_OUTCOME_07,A_SCOR_SCORE_VALUE_07) AS 'A_SCOR_ELEMENT_07',
                                    (A_SCOR_ELEMENT_08,A_SCOR_OUTCOME_08,A_SCOR_SCORE_VALUE_08) AS 'A_SCOR_ELEMENT_08',
                                    (A_SCOR_ELEMENT_09,A_SCOR_OUTCOME_09,A_SCOR_SCORE_VALUE_09) AS 'A_SCOR_ELEMENT_09',
                                    (A_SCOR_ELEMENT_10,A_SCOR_OUTCOME_10,A_SCOR_SCORE_VALUE_10) AS 'A_SCOR_ELEMENT_10',
                                    (A_SCOR_ELEMENT_11,A_SCOR_OUTCOME_11,A_SCOR_SCORE_VALUE_11) AS 'A_SCOR_ELEMENT_11',
                                    (A_SCOR_ELEMENT_12,A_SCOR_OUTCOME_12,A_SCOR_SCORE_VALUE_12) AS 'A_SCOR_ELEMENT_12',
                                    (A_SCOR_ELEMENT_13,A_SCOR_OUTCOME_13,A_SCOR_SCORE_VALUE_13) AS 'A_SCOR_ELEMENT_13',
                                    (A_SCOR_ELEMENT_14,A_SCOR_OUTCOME_14,A_SCOR_SCORE_VALUE_14) AS 'A_SCOR_ELEMENT_14',
                                    (A_SCOR_ELEMENT_15,A_SCOR_OUTCOME_15,A_SCOR_SCORE_VALUE_15) AS 'A_SCOR_ELEMENT_15',
                                    (A_SCOR_ELEMENT_16,A_SCOR_OUTCOME_16,A_SCOR_SCORE_VALUE_16) AS 'A_SCOR_ELEMENT_16',
                                    (A_SCOR_ELEMENT_17,A_SCOR_OUTCOME_17,A_SCOR_SCORE_VALUE_17) AS 'A_SCOR_ELEMENT_17',
                                    (A_SCOR_ELEMENT_18,A_SCOR_OUTCOME_18,A_SCOR_SCORE_VALUE_18) AS 'A_SCOR_ELEMENT_18',
                                    (A_SCOR_ELEMENT_19,A_SCOR_OUTCOME_19,A_SCOR_SCORE_VALUE_19) AS 'A_SCOR_ELEMENT_19',
                                    (A_SCOR_ELEMENT_20,A_SCOR_OUTCOME_20,A_SCOR_SCORE_VALUE_20) AS 'A_SCOR_ELEMENT_20'))
    WHERE               FACTOR IS NOT NULL
    AND                 FACTOR_BIN IS NOT NULL
    GROUP BY            RUN_DATE, RUN_ID, PRODUCT_TYPE, CUSTOMER_SEGMENT, FACTOR, FACTOR_BIN, FACTOR_SCORE, SCORE_ELEMENT, MONTHS_DIFF)
GROUP BY            RUN_DATE, RUN_ID, PRODUCT_TYPE, CUSTOMER_SEGMENT, FACTOR, FACTOR_BIN, FACTOR_SCORE, SCORE_ELEMENT
ORDER BY            RUN_ID DESC, PRODUCT_TYPE, CUSTOMER_SEGMENT, SCORE_ELEMENT;

-- Product Factor Analysis by Records & Exposure (B_Score)
CREATE OR REPLACE FORCE VIEW "PROD_FACTOR_B_SCORE_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            RUN_DATE, RUN_ID, PRODUCT_TYPE, CUSTOMER_SEGMENT, FACTOR, FACTOR_BIN, FACTOR_SCORE, "M_13+_RECORDS", "M_13+_EXPOSURE"
FROM (
    SELECT              RUN_DATE RUN_DATE, RUN_ID RUN_ID, PRODUCT_TYPE PRODUCT_TYPE, CUSTOMER_SEGMENT CUSTOMER_SEGMENT, 
                        FACTOR, FACTOR_BIN, FACTOR_SCORE, SCORE_ELEMENT, 
                        COUNT(CIC) AS "M_13+_RECORDS" , SUM(OUTSTANDING_AMT) AS "M_13+_EXPOSURE"
    FROM                (SELECT     B_REQ.SCOR_PORTFOLIO_DATE RUN_DATE, B_REQ.RUN_ID RUN_ID, B_REQ.SCOR_CIC, B_REQ.PROD_PRODUCT_TYPE PRODUCT_TYPE, 
                                    B_REQ.PROD_CUSTOMER_SEGMENT CUSTOMER_SEGMENT, 
                                    B_RES.B_SCOR_ELEMENT_01,B_RES.B_SCOR_OUTCOME_01,B_RES.B_SCOR_SCORE_VALUE_01,
                                    B_RES.B_SCOR_ELEMENT_02,B_RES.B_SCOR_OUTCOME_02,B_RES.B_SCOR_SCORE_VALUE_02,
                                    B_RES.B_SCOR_ELEMENT_03,B_RES.B_SCOR_OUTCOME_03,B_RES.B_SCOR_SCORE_VALUE_03,
                                    B_RES.B_SCOR_ELEMENT_04,B_RES.B_SCOR_OUTCOME_04,B_RES.B_SCOR_SCORE_VALUE_04,
                                    B_RES.B_SCOR_ELEMENT_05,B_RES.B_SCOR_OUTCOME_05,B_RES.B_SCOR_SCORE_VALUE_05,
                                    B_RES.B_SCOR_ELEMENT_06,B_RES.B_SCOR_OUTCOME_06,B_RES.B_SCOR_SCORE_VALUE_06,
                                    B_RES.B_SCOR_ELEMENT_07,B_RES.B_SCOR_OUTCOME_07,B_RES.B_SCOR_SCORE_VALUE_07,
                                    B_RES.B_SCOR_ELEMENT_08,B_RES.B_SCOR_OUTCOME_08,B_RES.B_SCOR_SCORE_VALUE_08,
                                    B_RES.B_SCOR_ELEMENT_09,B_RES.B_SCOR_OUTCOME_09,B_RES.B_SCOR_SCORE_VALUE_09,
                                    B_RES.B_SCOR_ELEMENT_10,B_RES.B_SCOR_OUTCOME_10,B_RES.B_SCOR_SCORE_VALUE_10,
                                    B_RES.B_SCOR_ELEMENT_11,B_RES.B_SCOR_OUTCOME_11,B_RES.B_SCOR_SCORE_VALUE_11,
                                    B_RES.B_SCOR_ELEMENT_12,B_RES.B_SCOR_OUTCOME_12,B_RES.B_SCOR_SCORE_VALUE_12,
                                    B_RES.B_SCOR_ELEMENT_13,B_RES.B_SCOR_OUTCOME_13,B_RES.B_SCOR_SCORE_VALUE_13,
                                    B_RES.B_SCOR_ELEMENT_14,B_RES.B_SCOR_OUTCOME_14,B_RES.B_SCOR_SCORE_VALUE_14,
                                    B_RES.B_SCOR_ELEMENT_15,B_RES.B_SCOR_OUTCOME_15,B_RES.B_SCOR_SCORE_VALUE_15,
                                    B_RES.B_SCOR_ELEMENT_16,B_RES.B_SCOR_OUTCOME_16,B_RES.B_SCOR_SCORE_VALUE_16,
                                    B_RES.B_SCOR_ELEMENT_17,B_RES.B_SCOR_OUTCOME_17,B_RES.B_SCOR_SCORE_VALUE_17,
                                    B_RES.B_SCOR_ELEMENT_18,B_RES.B_SCOR_OUTCOME_18,B_RES.B_SCOR_SCORE_VALUE_18,
                                    B_RES.B_SCOR_ELEMENT_19,B_RES.B_SCOR_OUTCOME_19,B_RES.B_SCOR_SCORE_VALUE_19,
                                    B_RES.B_SCOR_ELEMENT_20,B_RES.B_SCOR_OUTCOME_20,B_RES.B_SCOR_SCORE_VALUE_20,
                                    B_REQ.SCOR_CIC AS CIC, B_REQ.PROD_OUTSTANDING_AMOUNT_M0 AS OUTSTANDING_AMT
                        FROM        B_SCORE_REQUEST_HIST B_REQ, B_SCORE_RESPONSE B_RES
                        WHERE       B_REQ.REQUEST_ID = B_RES.REQUEST_ID
                        AND         B_REQ.SCOR_PORTFOLIO_DATE = B_RES.SCOR_PORTFOLIO_DATE)
                        UNPIVOT(
                            (FACTOR, FACTOR_BIN, FACTOR_SCORE)
                            FOR     SCORE_ELEMENT IN
                                    ((B_SCOR_ELEMENT_01,B_SCOR_OUTCOME_01,B_SCOR_SCORE_VALUE_01) AS 'B_SCOR_ELEMENT_01',
                                    (B_SCOR_ELEMENT_02,B_SCOR_OUTCOME_02,B_SCOR_SCORE_VALUE_02) AS 'B_SCOR_ELEMENT_02',
                                    (B_SCOR_ELEMENT_03,B_SCOR_OUTCOME_03,B_SCOR_SCORE_VALUE_03) AS 'B_SCOR_ELEMENT_03',
                                    (B_SCOR_ELEMENT_04,B_SCOR_OUTCOME_04,B_SCOR_SCORE_VALUE_04) AS 'B_SCOR_ELEMENT_04',
                                    (B_SCOR_ELEMENT_05,B_SCOR_OUTCOME_05,B_SCOR_SCORE_VALUE_05) AS 'B_SCOR_ELEMENT_05',
                                    (B_SCOR_ELEMENT_06,B_SCOR_OUTCOME_06,B_SCOR_SCORE_VALUE_06) AS 'B_SCOR_ELEMENT_06',
                                    (B_SCOR_ELEMENT_07,B_SCOR_OUTCOME_07,B_SCOR_SCORE_VALUE_07) AS 'B_SCOR_ELEMENT_07',
                                    (B_SCOR_ELEMENT_08,B_SCOR_OUTCOME_08,B_SCOR_SCORE_VALUE_08) AS 'B_SCOR_ELEMENT_08',
                                    (B_SCOR_ELEMENT_09,B_SCOR_OUTCOME_09,B_SCOR_SCORE_VALUE_09) AS 'B_SCOR_ELEMENT_09',
                                    (B_SCOR_ELEMENT_10,B_SCOR_OUTCOME_10,B_SCOR_SCORE_VALUE_10) AS 'B_SCOR_ELEMENT_10',
                                    (B_SCOR_ELEMENT_11,B_SCOR_OUTCOME_11,B_SCOR_SCORE_VALUE_11) AS 'B_SCOR_ELEMENT_11',
                                    (B_SCOR_ELEMENT_12,B_SCOR_OUTCOME_12,B_SCOR_SCORE_VALUE_12) AS 'B_SCOR_ELEMENT_12',
                                    (B_SCOR_ELEMENT_13,B_SCOR_OUTCOME_13,B_SCOR_SCORE_VALUE_13) AS 'B_SCOR_ELEMENT_13',
                                    (B_SCOR_ELEMENT_14,B_SCOR_OUTCOME_14,B_SCOR_SCORE_VALUE_14) AS 'B_SCOR_ELEMENT_14',
                                    (B_SCOR_ELEMENT_15,B_SCOR_OUTCOME_15,B_SCOR_SCORE_VALUE_15) AS 'B_SCOR_ELEMENT_15',
                                    (B_SCOR_ELEMENT_16,B_SCOR_OUTCOME_16,B_SCOR_SCORE_VALUE_16) AS 'B_SCOR_ELEMENT_16',
                                    (B_SCOR_ELEMENT_17,B_SCOR_OUTCOME_17,B_SCOR_SCORE_VALUE_17) AS 'B_SCOR_ELEMENT_17',
                                    (B_SCOR_ELEMENT_18,B_SCOR_OUTCOME_18,B_SCOR_SCORE_VALUE_18) AS 'B_SCOR_ELEMENT_18',
                                    (B_SCOR_ELEMENT_19,B_SCOR_OUTCOME_19,B_SCOR_SCORE_VALUE_19) AS 'B_SCOR_ELEMENT_19',
                                    (B_SCOR_ELEMENT_20,B_SCOR_OUTCOME_20,B_SCOR_SCORE_VALUE_20) AS 'B_SCOR_ELEMENT_20'))
    WHERE               FACTOR IS NOT NULL
    AND                 FACTOR_BIN IS NOT NULL
    GROUP BY            RUN_DATE, RUN_ID, PRODUCT_TYPE, CUSTOMER_SEGMENT, FACTOR, FACTOR_BIN, FACTOR_SCORE, SCORE_ELEMENT)
ORDER BY            RUN_ID DESC, PRODUCT_TYPE, CUSTOMER_SEGMENT, SCORE_ELEMENT;

--=================================================================================--
-- S1.2 - Operational Reports
--=================================================================================--

--      REPORT 1 -- Count of records for execution and run dates.
CREATE OR REPLACE FORCE VIEW "COUNT_REC_PER_EXECUTION_REPORT" AS 
SELECT /*+ PARALLEL(8)*/
       STG.RUN_ID           AS STG_RUN_ID, 
       STG.RUN_DATE         AS STG_RUN_DATE, 
       ARES.S_RUN_DATE      AS A_START_EXECUTION_DATE,
       BRES.S_RUN_DATE      AS B_START_EXECUTION_DATE,
       ARES.E_RUN_DATE      AS A_END_EXECUTION_DATE,
       BRES.E_RUN_DATE      AS B_END_EXECUTION_DATE,
       STG.ACCEPTED         AS STG_ACCEPTED_RECORDS, 
       NVL(BAD.REJECTED, 0) AS STG_REJECTED_RECORDS, 
       NVL(AREQ.SUCCESS, 0) AS A_SCORE_SUCCESSFUL_RECORDS, 
       NVL(AREQ.FAILED, 0)  AS A_SCORE_FAILED_RECORDS, 
       NVL(BREQ.SUCCESS, 0) AS B_SCORE_SUCCESSFUL_RECORDS, 
       NVL(BREQ.FAILED, 0)  AS B_SCORE_FAILED_RECORDS 
FROM   (SELECT RUN_ID, 
               MIN(RUN_DATE) AS RUN_DATE, 
               COUNT(*)      AS ACCEPTED 
        FROM   STG_SCORE_REQUEST_HIST 
        GROUP  BY RUN_ID) STG, 
       (SELECT RUN_ID, 
               MIN(CONT_RUN_DATE) AS RUN_DATE, 
               SUM(CASE 
                     WHEN PROCESS_STATUS = 'Proceed' THEN 1 
                     ELSE 0 
                   END)           AS SUCCESS, 
               SUM(CASE 
                     WHEN PROCESS_STATUS = 'Failed' THEN 1 
                     ELSE 0 
                   END)           AS FAILED 
        FROM   A_SCORE_REQUEST_HIST A 
        GROUP  BY RUN_ID) AREQ, 
       (SELECT RUN_ID, 
               MIN(SCOR_PORTFOLIO_DATE) AS RUN_DATE, 
               SUM(CASE 
                     WHEN PROCESS_STATUS = 'Proceed' THEN 1 
                     ELSE 0 
                   END)                 AS SUCCESS, 
               SUM(CASE 
                     WHEN PROCESS_STATUS = 'Failed' THEN 1 
                     ELSE 0 
                   END)                 AS FAILED 
        FROM   B_SCORE_REQUEST_HIST 
        GROUP  BY RUN_ID) BREQ, 
       (SELECT RUN_ID, 
               MIN(SCOR_EXECUTION_DATE_TIME) AS S_RUN_DATE, 
               MAX(SCOR_EXECUTION_DATE_TIME) AS E_RUN_DATE 
        FROM   A_SCORE_RESPONSE 
        GROUP  BY RUN_ID) ARES, 
       (SELECT RUN_ID, 
               MIN(SCOR_EXECUTION_DATE_TIME) AS S_RUN_DATE, 
               MAX(SCOR_EXECUTION_DATE_TIME) AS E_RUN_DATE
        FROM   B_SCORE_RESPONSE 
        GROUP  BY RUN_ID) BRES, 
       (SELECT RUN_ID, 
               COUNT(*) AS REJECTED 
        FROM   STG_SCORE_REQUEST_BAD_RECORDS 
        GROUP  BY RUN_ID) BAD 
WHERE  STG.RUN_ID = AREQ.RUN_ID(+)
       AND STG.RUN_ID = BREQ.RUN_ID(+)
       AND STG.RUN_ID = ARES.RUN_ID(+)
       AND STG.RUN_ID = BRES.RUN_ID(+)
       AND STG.RUN_ID = BAD.RUN_ID(+) 
ORDER  BY STG.RUN_ID DESC;          

--      REPORT 2 -- STG_SCORE_REQUEST bad records for execution and run dates.
CREATE OR REPLACE FORCE VIEW "STG_SCORE_REQ_BAD_REC_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            RUN_ID, RUN_DATE, EXECUTION_DATE_TIME, CONTRACT_NUMBER, CIC, PRODUCT_CODE, CUSTOMER_SEGMENT, OPEN_DATE, BRANCH_SHOWROOM_ACC, MILITARY_RANK, 
            DURATION_IN_MONTH, GROSS_SALARY, DEPENDENTS, DATE_OF_BIRTH, ARMS_PROPERTY_TYPE, ARMS_REGION, DOWNPAYMENT_AMT, ARMS_VEHICLE_BRAND_NAME, 
            RATE, ADD_RATE, ORIG_APPROVAL_AMT, SUB_CODE, DELINQ_DAYS, PRINCIPAL_OUTSTANDING, DELINQ_DAYS_M0, DELINQ_DAYS_M1, DELINQ_DAYS_M2, 
            DELINQ_DAYS_M3, DELINQ_DAYS_M4, DELINQ_DAYS_M5, DELINQ_DAYS_M6, DELINQ_DAYS_M7, DELINQ_DAYS_M8, DELINQ_DAYS_M9, DELINQ_DAYS_M10, 
            DELINQ_DAYS_M11, DELINQ_DAYS_M12, DELINQ_DAYS_M13, DELINQ_DAYS_M14, DELINQ_DAYS_M15, DELINQ_DAYS_M16, DELINQ_DAYS_M17, DELINQ_DAYS_M18, 
            DELINQ_DAYS_M19, DELINQ_DAYS_M20, DELINQ_DAYS_M21, DELINQ_DAYS_M22, DELINQ_DAYS_M23, DELINQ_DAYS_M24, EMI_M0, EMI_M1, EMI_M2, EMI_M3, 
            EMI_M4, EMI_M5, EMI_M6, EMI_M7, EMI_M8, EMI_M9, EMI_M10, EMI_M11, EMI_M12, EMI_M13, EMI_M14, EMI_M15, EMI_M16, EMI_M17, EMI_M18, EMI_M19, 
            EMI_M20, EMI_M21, EMI_M22, EMI_M23, EMI_M24, DELINQ_AMOUNT_M0, DELINQ_AMOUNT_M1, DELINQ_AMOUNT_M2, DELINQ_AMOUNT_M3, DELINQ_AMOUNT_M4, 
            DELINQ_AMOUNT_M5, DELINQ_AMOUNT_M6, DELINQ_AMOUNT_M7, DELINQ_AMOUNT_M8, DELINQ_AMOUNT_M9, DELINQ_AMOUNT_M10, DELINQ_AMOUNT_M11, 
            DELINQ_AMOUNT_M12, DELINQ_AMOUNT_M13, DELINQ_AMOUNT_M14, DELINQ_AMOUNT_M15, DELINQ_AMOUNT_M16, DELINQ_AMOUNT_M17, DELINQ_AMOUNT_M18, 
            DELINQ_AMOUNT_M19, DELINQ_AMOUNT_M20, DELINQ_AMOUNT_M21, DELINQ_AMOUNT_M22, DELINQ_AMOUNT_M23, DELINQ_AMOUNT_M24, OUTSTANDING_AMOUNT_M0, 
            OUTSTANDING_AMOUNT_M1, OUTSTANDING_AMOUNT_M2, OUTSTANDING_AMOUNT_M3, OUTSTANDING_AMOUNT_M4, OUTSTANDING_AMOUNT_M5, OUTSTANDING_AMOUNT_M6, 
            OUTSTANDING_AMOUNT_M7, OUTSTANDING_AMOUNT_M8, OUTSTANDING_AMOUNT_M9, OUTSTANDING_AMOUNT_M10, OUTSTANDING_AMOUNT_M11, OUTSTANDING_AMOUNT_M12, 
            OUTSTANDING_AMOUNT_M13, OUTSTANDING_AMOUNT_M14, OUTSTANDING_AMOUNT_M15, OUTSTANDING_AMOUNT_M16, OUTSTANDING_AMOUNT_M17, OUTSTANDING_AMOUNT_M18, 
            OUTSTANDING_AMOUNT_M19, OUTSTANDING_AMOUNT_M20, OUTSTANDING_AMOUNT_M21, OUTSTANDING_AMOUNT_M22, OUTSTANDING_AMOUNT_M23, OUTSTANDING_AMOUNT_M24, 
            AVERAGE_BALANCE_MONTH_M0, AVERAGE_BALANCE_MONTH_M1, AVERAGE_BALANCE_MONTH_M2, AVERAGE_BALANCE_MONTH_M3, AVERAGE_BALANCE_MONTH_M4, 
            AVERAGE_BALANCE_MONTH_M5, AVERAGE_BALANCE_MONTH_M6, AVERAGE_BALANCE_MONTH_M7, AVERAGE_BALANCE_MONTH_M8, AVERAGE_BALANCE_MONTH_M9, 
            AVERAGE_BALANCE_MONTH_M10, AVERAGE_BALANCE_MONTH_M11, AVERAGE_BALANCE_MONTH_M12, AVERAGE_BALANCE_MONTH_M13, AVERAGE_BALANCE_MONTH_M14, 
            AVERAGE_BALANCE_MONTH_M15, AVERAGE_BALANCE_MONTH_M16, AVERAGE_BALANCE_MONTH_M17, AVERAGE_BALANCE_MONTH_M18, AVERAGE_BALANCE_MONTH_M19, 
            AVERAGE_BALANCE_MONTH_M20, AVERAGE_BALANCE_MONTH_M21, AVERAGE_BALANCE_MONTH_M22, AVERAGE_BALANCE_MONTH_M23, AVERAGE_BALANCE_MONTH_M24, 
            ARMS_MITIGANT_CODE, ARMS_MITIGANT_DESC, ARMS_MITIGANT_VALUE, ARMS_COLL_AREA, ARMS_VEHICLE_BRAND_TYPE, ARMS_PROPERTY_EVAL_STATUS, 
            ARMS_MITIGANT_VALUE_BY_OWNER, ARMS_BOOK_VALUE, ARMS_VALUATION_DIFF, ARMS_CONTRACT_NUMBER, ARMS_MANUFACTURE_YEAR, ARMS_VEHICLE_MANUFACTURE_YEAR, 
            PRIMARY_CARD_FLG, SUPPLEMENTARY_CARD_LIMIT, RESIDENT_STATUS, RESIDENT_TYPE, SALARY_TRANSFER_TYPE_CIF, GENDER, MARITAL_STATUS, CITY, CIVIL_STATUS, 
            DISTRICT_CODE, EDUCATION_LEVEL, HOUSE_OWNED_STATUS, NATIONALITY, NUMBER_OF_CARS, OCCUPATION_TYPE, REGION, CIC_OPEN_DATE, ACCRUED_INT, BALLOON_AMOUNT, 
            BASIC_SALARY_AMOUNT, BRANCH_SHOWROOM_ACCOUNT_CODE, BRANCH_SHOWROOM_CODE, BUSINESS_POSITION, CHANNEL_CODE, CUR_BOOK_BAL, CURR_PAY, CURRENCY, CUS_SUBTYPE, 
            DEPT_CODE, DISBURSEMENT_AMOUNT, DISBURSEMENT_DATE, EMP_COMPANY, EMP_DEPARTMENT, EMPLOYEE_TYPE, EMPLOYER_CLASS_CODE, END_OF_SERVICE_BENEFIT_AMOUNT, 
            FEES, FINANCE_AMT, INSTAL_AMT, INSTALMENT_WITH_INSURANCE, MATURE_DATE, MONTHLY_ALLOWANCE_AMOUNT, MONTHLY_OTHER_INCOME_AMOUNT, NET_BAL, NO_OF_DELINQ_INST, 
            ORIG_BALANCE, ORIG_PAY, ORIG_PROFIT, OTHER_MONTHLY_DEDUCTION_AMT, OUTSTANDING_WITH_TOTAL_PROFIT, PAYMENT_PRINCIPAL_AMT, PRODUCT_TYPE, PROFIT_RATE_SUB_TYPE, 
            RELATION_CONTRACT_TYPE, REMAIN_PAYMENTS, REMAIN_TERM, SALARY_TRANSFER_TYPE, SALARY_TRANSFER, SALES_BRANCH, SALES_CD, SALES_USERID, TERM, 
            TOT_GRACE_PRD_PROFIT, TOTAL_PAYMENTS, TOTAL_EARLY_PAYMENT_AMT, TOTAL_INSTALLMENT_DUE_AMT, RL_FOOD_BEVERAGES, RL_HOUSING, RL_UTILITIES, RL_HEALTHCARE, 
            RL_TRANSPORT, RL_COMMUNICATIONS, RL_EDUCATION_FEES, RL_HOME_SERVANTS, RL_FEES_ON_EXPATS, RL_OTHER_FUTURE_EXPENSES, RL_OTHER_INCOME, RL_TOTAL_EXPENSES, 
            RL_OTHER_OBLIGATIONS, SCORING_REQUEST_TYPE, SCORING_STAGE, SCORING_SOURCE, APPEND_DB_CODE, APPLICATION_ID, NATIONAL_ID, DB_TABLE_CODE, TRANSACTION_ID, 
            CODE_1, CODE_2, CODE_3, CODE_4, CODE_5, CODE_6, CODE_7, CODE_8, CODE_9, CODE_10, PROGRESS_NUMBER, PORTFOLIO_DATE, TOTAL_LIABILITIES, NO_OF_LOANS, 
            TOTAL_LIMIT, TOTAL_REVOLVING_LIMIT, TOTAL_REVOLVING_LIAB, NO_OF_ENQUIRIES_12M, NO_OF_ENQUIRIES_30D, NO_OF_BOUNCED_CHEQUE, SIMAH_SCORE, SIMAH_SCORE_VERSION, 
            WORST_DELINQUENT_24M_CRC, WORST_DELINQUENT_24M_PLN, WORST_DELINQUENT_24M_AUTO, WORST_DELINQUENT_24M_MTG, WORST_DELINQUENT_24M_OTHER, 
            CURRENT_WORST_DELINQUENT_CRC, CURRENT_WORST_DELINQUENT_PLN, CURRENT_WORST_DELINQUENT_AUTO, CURRENT_WORST_DELINQUENT_MTG, CURRENT_WORST_DELINQUENT_OTHER, 
            CONTRACTUAL_PAYMENT_CRC, CONTRACTUAL_PAYMENT_PLN, CONTRACTUAL_PAYMENT_AUTO, CONTRACTUAL_PAYMENT_MTG, CONTRACTUAL_PAYMENT_OTHER, NUMBER_OF_DEFAULT_CRC, 
            NUMBER_OF_DEFAULT_PLN, NUMBER_OF_DEFAULT_AUTO, NUMBER_OF_DEFAULT_MTG, NUMBER_OF_DEFAULT_OTHER, NUMBER_OF_CI_DEFAULT_CRC, NUMBER_OF_CI_DEFAULT_PLN, 
            NUMBER_OF_CI_DEFAULT_AUTO, NUMBER_OF_CI_DEFAULT_MTG, NUMBER_OF_CI_DEFAULT_OTHER, SUMMED_SALARY, DEBT_BURDEN, DEBT_BURDEN_RATIO, NUMBER_OF_EXECUTED_EXJUDG, 
            NUMBER_OF_NOT_EXECUTED_EXJUDG, OUTSTANDING_BALANCE_NOTEXJUDG, CARD_PRODUCT_LIMIT, CARD_PRODUCT_CODE, CARD_OUTSTANDING_BALANCE, ACCOUNT_1, APPLICATION_DATE, 
            APPROVAL_DATE, BRANCH_LOAN_APPLIED, EMPLOYER_ENGAGEMENT_DT, H_CATEGORY_PRODUCT, LAST_PAYMENT, NEXT_PAY, ORG_UNIT, ORIG_TERM, PAY_FREQUENCY, FTV, 
            OUTSTANDING_WITH_ACCRUAL_PFT
FROM        STG_SCORE_REQUEST_BAD_RECORDS
ORDER BY    RUN_ID DESC, CONTRACT_NUMBER, CIC;

--      REPORT 3 -- A_SCORE_REQUEST_HIST failed records for execution and run dates.
CREATE OR REPLACE FORCE VIEW "A_SCORE_REQ_FAILED_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            RUN_ID, CONT_RUN_DATE, SCOR_EXECUTION_DATE_TIME, REQUEST_ID, PROCESS_STATUS, CONT_CIC, CONT_CONTRACT_NUMBER, CONT_PRODUCT_CODE, CONT_PRODUCT_TYPE, 
            CONT_CUSTOMER_SEGMENT, CUST_SALARY_TRANSFER_TYPE_CIF, CONT_SALARY_TRANSFER_TYPE_CTF, CONT_SALARY_TRANSFER_TYPE, CONT_ADD_RATE, CONT_ACCOUNT_ID, 
            CONT_ACCRUED_INT, CONT_APPLICATION_DATE, CONT_APPROVAL_DATE, CONT_BALLOON_AMOUNT, CONT_BASIC_SALARY_AMOUNT, CONT_BRANCH_LOAN_APPLIED, 
            CONT_BRANCH_SHOWROOM_ACC, CONT_BUSINESS_POSITION, CONT_CUR_BOOK_BAL, CONT_CURR_PAY, CONT_CURRENCY, CONT_CUS_SUBTYPE, CONT_DEBT_BURDEN_RATIO, 
            CONT_DELINQ_DAYS, CONT_DEPENDENTS, CONT_DEPT_CODE, CONT_DISBURSEMENT_DATE, CONT_DISBURSEMENT_AMOUNT, CONT_DOWNPAYMENT_AMT, CONT_EMP_DEPARTMENT, 
            CONT_EMP_COMPANY, CONT_EMPLOYER_ENGAGEMENT_DATE, CONT_FEES, CONT_FINANCE_AMT, CONT_GROSS_SALARY, CONT_H_CATEGORY_PRODUCT, CONT_INSTAL_AMT, 
            CONT_INSTAL_WITH_INSURANCE, CONT_LAST_PAYMENT_DATE, CONT_MATURE_DATE, CONT_MILITARY_RANK, CONT_NET_BAL, CONT_NEXT_PAY_DATE, CONT_NO_OF_DELINQ_INST, 
            CONT_OPEN_DATE, CONT_ORG_UNIT, CONT_ORIG_APPROVAL_AMT, CONT_ORIG_BALANCE, CONT_ORIG_PAY, CONT_ORIG_PROFIT, CONT_ORIG_TERM, CONT_PAY_FREQUENCY, 
            CONT_PAYMENT_PRINCIPAL_AMT, CONT_PROFIT_RATE_SUB_TYPE, CONT_RATE, CONT_TOTAL_PAYMENTS, CONT_REMAIN_PAYMENTS, CONT_REMAIN_TERM, CUST_RESIDENT_STATUS, 
            CUST_RESIDENT_TYPE, CONT_SALES_BRANCH, CONT_SALES_CD, CONT_SALES_USERID, CONT_TERM, CONT_TOT_GRACE_PRD_PROFIT, CONT_TOTAL_EARLY_PAYMENT_AMT, 
            CONT_TOTAL_INSTAL_DUE_AMT, CUST_GENDER, CUST_MARITAL_STATUS, CUST_DATE_OF_BIRTH, CONT_BRANCH_SHOWROOM_ACC_CODE, CONT_BRANCH_SHOWROOM_CODE, 
            CONT_CHANNEL_CODE, CUST_CITY, CUST_CIVIL_STATUS, CUST_DISTRICT_CODE, CONT_DURATION_IN_MONTH, CUST_EDUCATION_LEVEL, CONT_EMPLOYEE_TYPE, 
            CONT_EMPLOYER_CLASS_CODE, CONT_END_SERVICE_BENEFIT_AMT, CUST_HOUSE_OWNED_STATUS, CONT_MONTHLY_ALLOWANCE_AMOUNT, CONT_MONTHLY_OTHER_INCOME_AMT, 
            CUST_NATIONALITY, CUST_NUMBER_OF_CARS, CUST_OCCUPATION_TYPE, CONT_OTHER_MONTHLY_DEDUCT_AMT, CUST_REGION, CONT_RELATION_CONTRACT_TYPE, 
            RESP_RL_FOOD_BEVERAGES, RESP_RL_HOUSING, RESP_RL_UTILITIES, RESP_RL_HEALTHCARE, RESP_RL_TRANSPORT, RESP_RL_COMMUNICATIONS, RESP_RL_EDUCATION_FEES, 
            RESP_RL_HOME_SERVANTS, RESP_RL_FEES_ON_EXPATS, RESP_RL_OTHER_FUTURE_EXPENSES, RESP_RL_OTHER_INCOME, RESP_RL_TOTAL_EXPENSES, RESP_RL_OTHER_OBLIGATIONS, 
            ARMS_ARMS_MITIGANT_CODE, ARMS_ARMS_MITIGANT_DESC, ARMS_ARMS_MITIGANT_VALUE, ARMS_ARMS_COLL_AREA, ARMS_ARMS_VEHICLE_BRAND_NAME, 
            ARMS_ARMS_VEHICLE_BRAND_TYPE, ARMS_ARMS_PROP_EVAL_STATUS, ARMS_ARMS_MITIGANT_VAL_OWNER, ARMS_ARMS_BOOK_VALUE, ARMS_ARMS_VALUATION_DIFF, 
            ARMS_ARMS_CONTRACT_NUMBER, ARMS_ARMS_MANUFACTURE_YEAR, ARMS_ARMS_VEHI_MANUFACT_YEAR, ARMS_ARMS_REGION, ARMS_ARMS_PROPERTY_TYPE, SIMAH_TOTAL_LIABILITIES, 
            SIMAH_NO_OF_LOANS, SIMAH_TOTAL_LIMIT, SIMAH_TOTAL_REVOLVING_LIMIT, SIMAH_TOTAL_REVOLVING_LIAB, SIMAH_NO_OF_ENQUIRIES_12M, SIMAH_NO_OF_ENQUIRIES_30D, 
            SIMAH_NO_OF_BOUNCED_CHEQUE, SIMAH_SIMAH_SCORE, SIMAH_SIMAH_SCORE_VERSION, SIMAH_WORST_DELINQ_24M_CRC, SIMAH_WORST_DELINQ_24M_PLN, SIMAH_WORST_DELINQ_24M_AUTO, 
            SIMAH_WORST_DELINQ_24M_MTG, SIMAH_WORST_DELINQ_24M_OTHER, SIMAH_CUR_WORST_DELINQ_CRC, SIMAH_CUR_WORST_DELINQ_PLN, SIMAH_CUR_WORST_DELINQ_AUTO, 
            SIMAH_CUR_WORST_DELINQ_MTG, SIMAH_CUR_WORST_DELINQ_OTHER, SIMAH_CONTRACTUAL_PAY_CRC, SIMAH_CONTRACTUAL_PAY_PLN, SIMAH_CONTRACTUAL_PAY_AUTO, 
            SIMAH_CONTRACTUAL_PAY_MTG, SIMAH_CONTRACTUAL_PAY_OTHER, SIMAH_NO_OF_DEFAULT_CRC, SIMAH_NO_OF_DEFAULT_PLN, SIMAH_NO_OF_DEFAULT_AUTO, SIMAH_NO_OF_DEFAULT_MTG, 
            SIMAH_NO_OF_DEFAULT_OTHER, SIMAH_NO_OF_CI_DEFAULT_CRC, SIMAH_NO_OF_CI_DEFAULT_PLN, SIMAH_NO_OF_CI_DEFAULT_AUTO, SIMAH_NO_OF_CI_DEFAULT_MTG, 
            SIMAH_NO_OF_CI_DEFAULT_OTHER, SIMAH_SUMMED_SALARY, SIMAH_DEBT_BURDEN, SIMAH_DEBT_BURDEN_RATIO, SIMAH_NO_OF_EXECUTED_EXJUDG, SIMAH_NO_OF_NOTEXEC_EXJUDG, 
            SIMAH_OUTSTAND_BAL_NOTEXJUDG, CONT_PRINCIPAL_OUTSTANDING, CONT_OUTSTANDING_ACCRUVAL_PFT, CONT_OUTSTANDING_TOTAL_PFT, CONT_SUB_CODE, CASA_AVERAGE_BAL_MONTH_M0, 
            CASA_AVERAGE_BAL_MONTH_M1, CASA_AVERAGE_BAL_MONTH_M2, CASA_AVERAGE_BAL_MONTH_M3, CASA_AVERAGE_BAL_MONTH_M4, CASA_AVERAGE_BAL_MONTH_M5, CASA_AVERAGE_BAL_MONTH_M6, 
            CASA_AVERAGE_BAL_MONTH_M7, CASA_AVERAGE_BAL_MONTH_M8, CASA_AVERAGE_BAL_MONTH_M9, CASA_AVERAGE_BAL_MONTH_M10, CASA_AVERAGE_BAL_MONTH_M11, CARD_BRANCH_SHOWROOM_ACC, 
            SIMAH_CARD_PRODUCT_LIMIT, SIMAH_CARD_PRODUCT_CODE, SIMAH_CARD_OUTSTANDING_BAL, CARD_PRIMARY_CARD_FLG, CARD_SUPPLEMENTARY_CARD_LIMIT, SCOR_SCORING_REQUEST_TYPE, 
            SCOR_SCORING_STAGE, SCOR_SCORING_SOURCE, SCOR_APPEND_DB_CODE, SCOR_APPLICATION_ID, SCOR_NATIONAL_ID, SCOR_DB_TABLE_CODE, SCOR_TRANSACTION_ID, SCOR_CODE_01, 
            SCOR_CODE_02, SCOR_CODE_03, SCOR_CODE_04, SCOR_CODE_05, SCOR_CODE_06, SCOR_CODE_07, SCOR_CODE_08, SCOR_CODE_09, SCOR_CODE_10, SCOR_PROGRESS_NUMBER, 
            CUST_CIC_OPEN_DATE, CONT_TRANSACTION_DATE
FROM        A_SCORE_REQUEST_HIST            
WHERE       UPPER(PROCESS_STATUS) = 'FAILED'
ORDER BY    RUN_ID DESC, REQUEST_ID DESC;

--      REPORT 4 -- B_SCORE_REQUEST_HIST failed records for execution and run dates.
CREATE OR REPLACE FORCE VIEW "B_SCORE_REQ_FAILED_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            RUN_ID, SCOR_PORTFOLIO_DATE, REQUEST_ID, PROCESS_STATUS, SCOR_CIC, PROD_PRODUCT_CODE, PROD_PRODUCT_TYPE, PROD_CUSTOMER_SEGMENT, PROD_SALARY_TRANSFER_TYPE, 
            PROD_SALARY_TRANSFER_TYPE_CTF, PROD_ADD_RATE, CUST_CIC_OPEN_DATE, CUST_CITY, CUST_CIVIL_STATUS, CUST_DATE_OF_BIRTH, CUST_DISTRICT_CODE, 
            CUST_EDUCATION_LEVEL, CUST_GENDER, CUST_HOUSE_OWNED_STATUS, CUST_LATEST_EMP_COMPANY, CUST_LATEST_EMP_DEPARTMENT, CUST_MARITAL_STATUS, CUST_NATIONALITY, 
            CUST_NUMBER_OF_CARS, CUST_OCCUPATION_TYPE, CUST_REGION, CUST_RESIDENT_STATUS, CUST_RESIDENT_TYPE, CUST_SALARY_TRANSFER_TYPE_CIF, CUST_TOT_NO_ACTIVE_CONTRACTS, 
            PROD_ARMS_BOOK_VALUE, PROD_ARMS_COLL_AREA, PROD_ARMS_CONTRACT_NUMBER, PROD_ARMS_MANUFACTURE_YEAR, PROD_ARMS_MITIGANT_CODE, PROD_ARMS_MITIGANT_DESC, 
            PROD_ARMS_MITIGANT_VALUE, PROD_ARMS_MITIGANT_VAL_OWNER, PROD_ARMS_PROPERTY_TYPE, PROD_ARMS_PROP_EVAL_STATUS, PROD_ARMS_REGION, PROD_ARMS_VALUATION_DIFF, 
            PROD_ARMS_VEHICLE_BRAND_CAT, PROD_ARMS_VEHICLE_BRAND_NAME, PROD_ARMS_VEHICLE_BRAND_TYPE, PROD_ARMS_VEHI_MANUFACT_YEAR, CASA_AVERAGE_BAL_MONTH_M0, 
            CASA_AVERAGE_BAL_MONTH_M1, CASA_AVERAGE_BAL_MONTH_M2, CASA_AVERAGE_BAL_MONTH_M3, CASA_AVERAGE_BAL_MONTH_M4, CASA_AVERAGE_BAL_MONTH_M5, CASA_AVERAGE_BAL_MONTH_M6, 
            CASA_AVERAGE_BAL_MONTH_M7, CASA_AVERAGE_BAL_MONTH_M8, CASA_AVERAGE_BAL_MONTH_M9, CASA_AVERAGE_BAL_MONTH_M10, CASA_AVERAGE_BAL_MONTH_M11, CASA_AVERAGE_BAL_MONTH_M12, 
            CASA_AVERAGE_BAL_MONTH_M13, CASA_AVERAGE_BAL_MONTH_M14, CASA_AVERAGE_BAL_MONTH_M15, CASA_AVERAGE_BAL_MONTH_M16, CASA_AVERAGE_BAL_MONTH_M17, 
            CASA_AVERAGE_BAL_MONTH_M18, CASA_AVERAGE_BAL_MONTH_M19, CASA_AVERAGE_BAL_MONTH_M20, CASA_AVERAGE_BAL_MONTH_M21, CASA_AVERAGE_BAL_MONTH_M22, 
            CASA_AVERAGE_BAL_MONTH_M23, CASA_AVERAGE_BAL_MONTH_M24, PROD_DELINQ_AMOUNT_M0, PROD_DELINQ_AMOUNT_M1, PROD_DELINQ_AMOUNT_M2, PROD_DELINQ_AMOUNT_M3, 
            PROD_DELINQ_AMOUNT_M4, PROD_DELINQ_AMOUNT_M5, PROD_DELINQ_AMOUNT_M6, PROD_DELINQ_AMOUNT_M7, PROD_DELINQ_AMOUNT_M8, PROD_DELINQ_AMOUNT_M9, PROD_DELINQ_AMOUNT_M10, 
            PROD_DELINQ_AMOUNT_M11, PROD_DELINQ_AMOUNT_M12, PROD_DELINQ_AMOUNT_M13, PROD_DELINQ_AMOUNT_M14, PROD_DELINQ_AMOUNT_M15, PROD_DELINQ_AMOUNT_M16, 
            PROD_DELINQ_AMOUNT_M17, PROD_DELINQ_AMOUNT_M18, PROD_DELINQ_AMOUNT_M19, PROD_DELINQ_AMOUNT_M20, PROD_DELINQ_AMOUNT_M21, PROD_DELINQ_AMOUNT_M22, 
            PROD_DELINQ_AMOUNT_M23, PROD_DELINQ_AMOUNT_M24, PROD_DELINQ_DAYS_M0, PROD_DELINQ_DAYS_M1, PROD_DELINQ_DAYS_M2, PROD_DELINQ_DAYS_M3, PROD_DELINQ_DAYS_M4, 
            PROD_DELINQ_DAYS_M5, PROD_DELINQ_DAYS_M6, PROD_DELINQ_DAYS_M7, PROD_DELINQ_DAYS_M8, PROD_DELINQ_DAYS_M9, PROD_DELINQ_DAYS_M10, PROD_DELINQ_DAYS_M11, 
            PROD_DELINQ_DAYS_M12, PROD_DELINQ_DAYS_M13, PROD_DELINQ_DAYS_M14, PROD_DELINQ_DAYS_M15, PROD_DELINQ_DAYS_M16, PROD_DELINQ_DAYS_M17, PROD_DELINQ_DAYS_M18, 
            PROD_DELINQ_DAYS_M19, PROD_DELINQ_DAYS_M20, PROD_DELINQ_DAYS_M21, PROD_DELINQ_DAYS_M22, PROD_DELINQ_DAYS_M23, PROD_DELINQ_DAYS_M24, PROD_EMI_M0, PROD_EMI_M1, 
            PROD_EMI_M2, PROD_EMI_M3, PROD_EMI_M4, PROD_EMI_M5, PROD_EMI_M6, PROD_EMI_M7, PROD_EMI_M8, PROD_EMI_M9, PROD_EMI_M10, PROD_EMI_M11, PROD_EMI_M12, PROD_EMI_M13, 
            PROD_EMI_M14, PROD_EMI_M15, PROD_EMI_M16, PROD_EMI_M17, PROD_EMI_M18, PROD_EMI_M19, PROD_EMI_M20, PROD_EMI_M21, PROD_EMI_M22, PROD_EMI_M23, PROD_EMI_M24, 
            PROD_OUTSTANDING_AMOUNT_M0, PROD_OUTSTANDING_AMOUNT_M1, PROD_OUTSTANDING_AMOUNT_M2, PROD_OUTSTANDING_AMOUNT_M3, PROD_OUTSTANDING_AMOUNT_M4, 
            PROD_OUTSTANDING_AMOUNT_M5, PROD_OUTSTANDING_AMOUNT_M6, PROD_OUTSTANDING_AMOUNT_M7, PROD_OUTSTANDING_AMOUNT_M8, PROD_OUTSTANDING_AMOUNT_M9, 
            PROD_OUTSTANDING_AMOUNT_M10, PROD_OUTSTANDING_AMOUNT_M11, PROD_OUTSTANDING_AMOUNT_M12, PROD_OUTSTANDING_AMOUNT_M13, PROD_OUTSTANDING_AMOUNT_M14, 
            PROD_OUTSTANDING_AMOUNT_M15, PROD_OUTSTANDING_AMOUNT_M16, PROD_OUTSTANDING_AMOUNT_M17, PROD_OUTSTANDING_AMOUNT_M18, PROD_OUTSTANDING_AMOUNT_M19, 
            PROD_OUTSTANDING_AMOUNT_M20, PROD_OUTSTANDING_AMOUNT_M21, PROD_OUTSTANDING_AMOUNT_M22, PROD_OUTSTANDING_AMOUNT_M23, PROD_OUTSTANDING_AMOUNT_M24, 
            PROD_ACCRUED_INT, PROD_BALLOON_AMOUNT, PROD_BASIC_SALARY_AMOUNT, PROD_BRANCH_SHOWROOM_ACC, PROD_BRANCH_SHOWROOM_ACC_CODE, PROD_BRANCH_SHOWROOM_CODE, 
            PROD_BUSINESS_POSITION, PROD_CHANNEL_CODE, PROD_CUR_BOOK_BAL, PROD_CURR_PAY, PROD_CURRENCY, PROD_CUS_SUBTYPE, PROD_DEBT_BURDEN_RATIO, PROD_DEPENDENTS, 
            PROD_DEPT_CODE, PROD_DISBURSEMENT_AMOUNT, PROD_DISBURSEMENT_DATE, PROD_DOWNPAYMENT_AMT, PROD_DURATION_IN_MONTH, PROD_EMP_COMPANY, PROD_EMP_DEPARTMENT, 
            PROD_EMPLOYEE_TYPE, PROD_EMPLOYER_CLASS_CODE, PROD_EMPLOYER_ENGAGEMENT_DATE, PROD_END_SERVICE_BENEFIT_AMT, PROD_FEES, PROD_FINANCE_AMT, PROD_FIRST_APPLICATION_DATE, 
            PROD_FIRST_APPROVAL_DATE, PROD_FIRST_OPEN_DATE, PROD_GROSS_SALARY, PROD_INSTAL_AMT, PROD_INSTAL_WITH_INSURANCE, PROD_LAST_APPLICATION_DATE, PROD_LAST_APPROVAL_DATE, 
            PROD_LAST_OPEN_DATE, PROD_LAST_PAYMENT_DATE, PROD_MATURE_DATE, PROD_MILITARY_RANK, PROD_MONTHLY_ALLOWANCE_AMT, PROD_MONTHLY_OTHER_INCOME_AMT, PROD_NET_BAL, 
            PROD_NEXT_PAY_DATE, PROD_NO_OF_DELINQ_INST, PROD_ORIG_APPROVAL_AMT, PROD_ORIG_BALANCE, PROD_ORIG_PAY, PROD_ORIG_PROFIT, PROD_OTH_MONTHLY_DEDUCT_AMT, 
            PROD_OUTSTANDING_ACCRUAL_PFT, PROD_OUTSTANDING_TOTAL_PFT, PROD_PAYMENT_PRINCIPAL_AMT, PROD_PROFIT_RATE_SUB_TYPE, PROD_RATE, PROD_RELATION_CONTRACT_TYPE, 
            PROD_REMAIN_PAYMENTS, PROD_REMAIN_TERM, PROD_SALES_BRANCH, PROD_SALES_CD, PROD_SALES_USERID, PROD_SUB_CODE, PROD_TERM, PROD_TOT_GRACE_PRD_PROFIT, 
            PROD_TOTAL_PAYMENTS, PROD_TOTAL_EARLY_PAYMENT_AMT, PROD_TOTAL_INSTALL_DUE_AMT, PROD_TOTAL_NO_OPEN_CONTRACTS, RESP_RL_COMMUNICATIONS, RESP_RL_EDUCATION_FEES, 
            RESP_RL_FEES_ON_EXPATS, RESP_RL_FOOD_BEVERAGES, RESP_RL_HEALTHCARE, RESP_RL_HOME_SERVANTS, RESP_RL_HOUSING, RESP_RL_OTHER_FUTURE_EXPENSES, RESP_RL_OTHER_INCOME, 
            RESP_RL_OTHER_OBLIGATIONS, RESP_RL_TOTAL_EXPENSES, RESP_RL_TRANSPORT, RESP_RL_UTILITIES, SCOR_CODE_01, SCOR_CODE_02, SCOR_CODE_03, SCOR_CODE_04, SCOR_CODE_05, 
            SCOR_CODE_06, SCOR_CODE_07, SCOR_CODE_08, SCOR_CODE_09, SCOR_CODE_10, SCOR_NATIONAL_ID, SCOR_SCORING_REQUEST_TYPE, SCOR_SCORING_SOURCE, SCOR_TRANSACTION_ID, 
            SIMAH_CARD_OUTSTANDING_BAL, SIMAH_CARD_PRODUCT_CODE, SIMAH_CARD_PRODUCT_LIMIT, SIMAH_CONTRACTUAL_PAY_AUTO, SIMAH_CONTRACTUAL_PAY_CRC, SIMAH_CONTRACTUAL_PAY_MTG, 
            SIMAH_CONTRACTUAL_PAY_OTHER, SIMAH_CONTRACTUAL_PAY_PLN, SIMAH_CUR_WORST_DELINQ_AUTO, SIMAH_CUR_WORST_DELINQ_CRC, SIMAH_CUR_WORST_DELINQ_MTG, 
            SIMAH_CUR_WORST_DELINQ_OTHER, SIMAH_CUR_WORST_DELINQ_PLN, SIMAH_DEBT_BURDEN, SIMAH_DEBT_BURDEN_RATIO, SIMAH_NO_OF_BOUNCED_CHEQUE, SIMAH_NO_OF_ENQUIRIES_12M, 
            SIMAH_NO_OF_ENQUIRIES_30D, SIMAH_NO_OF_LOANS, SIMAH_NO_OF_CI_DEFAULT_AUTO, SIMAH_NO_OF_CI_DEFAULT_CRC, SIMAH_NO_OF_CI_DEFAULT_MTG, SIMAH_NO_OF_CI_DEFAULT_OTHER, 
            SIMAH_NO_OF_CI_DEFAULT_PLN, SIMAH_NO_OF_DEFAULT_AUTO, SIMAH_NO_OF_DEFAULT_CRC, SIMAH_NO_OF_DEFAULT_MTG, SIMAH_NO_OF_DEFAULT_OTHER, SIMAH_NO_OF_DEFAULT_PLN, 
            SIMAH_NO_OF_EXEC_EXJUDG, SIMAH_NO_OF_NOTEXEC_EXJUDG, SIMAH_OUTSTAND_BAL_NOTEXJUDG, SIMAH_SIMAH_SCORE, SIMAH_SIMAH_SCORE_VERSION, SIMAH_SUMMED_SALARY, 
            SIMAH_TOTAL_LIABILITIES, SIMAH_TOTAL_LIMIT, SIMAH_TOTAL_REVOLVING_LIAB, SIMAH_TOTAL_REVOLVING_LIMIT, SIMAH_WORST_DELINQ_24M_AUTO, SIMAH_WORST_DELINQ_24M_OTHER, 
            SIMAH_WORST_DELINQ_24M_PLN, SIMAH_WORST_DELINQ_24M_CRC, SIMAH_WORST_DELINQ_24M_MTG
FROM        B_SCORE_REQUEST_HIST            
WHERE       UPPER(PROCESS_STATUS) = 'FAILED'
ORDER BY    RUN_ID DESC, REQUEST_ID DESC;            

--      REPORT 5 -- A_SCORE_REQUEST_HIST records for execution and run dates.
CREATE OR REPLACE FORCE VIEW "A_SCORE_REQ_PROCESSED_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            RUN_ID, CONT_RUN_DATE, SCOR_EXECUTION_DATE_TIME, REQUEST_ID, PROCESS_STATUS, CONT_CIC, CONT_CONTRACT_NUMBER, CONT_PRODUCT_CODE, CONT_PRODUCT_TYPE, 
            CONT_CUSTOMER_SEGMENT, CUST_SALARY_TRANSFER_TYPE_CIF, CONT_SALARY_TRANSFER_TYPE_CTF, CONT_SALARY_TRANSFER_TYPE, CONT_ADD_RATE, CONT_ACCOUNT_ID, 
            CONT_ACCRUED_INT, CONT_APPLICATION_DATE, CONT_APPROVAL_DATE, CONT_BALLOON_AMOUNT, CONT_BASIC_SALARY_AMOUNT, CONT_BRANCH_LOAN_APPLIED, 
            CONT_BRANCH_SHOWROOM_ACC, CONT_BUSINESS_POSITION, CONT_CUR_BOOK_BAL, CONT_CURR_PAY, CONT_CURRENCY, CONT_CUS_SUBTYPE, CONT_DEBT_BURDEN_RATIO, 
            CONT_DELINQ_DAYS, CONT_DEPENDENTS, CONT_DEPT_CODE, CONT_DISBURSEMENT_DATE, CONT_DISBURSEMENT_AMOUNT, CONT_DOWNPAYMENT_AMT, CONT_EMP_DEPARTMENT, 
            CONT_EMP_COMPANY, CONT_EMPLOYER_ENGAGEMENT_DATE, CONT_FEES, CONT_FINANCE_AMT, CONT_GROSS_SALARY, CONT_H_CATEGORY_PRODUCT, CONT_INSTAL_AMT, 
            CONT_INSTAL_WITH_INSURANCE, CONT_LAST_PAYMENT_DATE, CONT_MATURE_DATE, CONT_MILITARY_RANK, CONT_NET_BAL, CONT_NEXT_PAY_DATE, CONT_NO_OF_DELINQ_INST, 
            CONT_OPEN_DATE, CONT_ORG_UNIT, CONT_ORIG_APPROVAL_AMT, CONT_ORIG_BALANCE, CONT_ORIG_PAY, CONT_ORIG_PROFIT, CONT_ORIG_TERM, CONT_PAY_FREQUENCY, 
            CONT_PAYMENT_PRINCIPAL_AMT, CONT_PROFIT_RATE_SUB_TYPE, CONT_RATE, CONT_TOTAL_PAYMENTS, CONT_REMAIN_PAYMENTS, CONT_REMAIN_TERM, CUST_RESIDENT_STATUS, 
            CUST_RESIDENT_TYPE, CONT_SALES_BRANCH, CONT_SALES_CD, CONT_SALES_USERID, CONT_TERM, CONT_TOT_GRACE_PRD_PROFIT, CONT_TOTAL_EARLY_PAYMENT_AMT, 
            CONT_TOTAL_INSTAL_DUE_AMT, CUST_GENDER, CUST_MARITAL_STATUS, CUST_DATE_OF_BIRTH, CONT_BRANCH_SHOWROOM_ACC_CODE, CONT_BRANCH_SHOWROOM_CODE, 
            CONT_CHANNEL_CODE, CUST_CITY, CUST_CIVIL_STATUS, CUST_DISTRICT_CODE, CONT_DURATION_IN_MONTH, CUST_EDUCATION_LEVEL, CONT_EMPLOYEE_TYPE, 
            CONT_EMPLOYER_CLASS_CODE, CONT_END_SERVICE_BENEFIT_AMT, CUST_HOUSE_OWNED_STATUS, CONT_MONTHLY_ALLOWANCE_AMOUNT, CONT_MONTHLY_OTHER_INCOME_AMT, 
            CUST_NATIONALITY, CUST_NUMBER_OF_CARS, CUST_OCCUPATION_TYPE, CONT_OTHER_MONTHLY_DEDUCT_AMT, CUST_REGION, CONT_RELATION_CONTRACT_TYPE, 
            RESP_RL_FOOD_BEVERAGES, RESP_RL_HOUSING, RESP_RL_UTILITIES, RESP_RL_HEALTHCARE, RESP_RL_TRANSPORT, RESP_RL_COMMUNICATIONS, RESP_RL_EDUCATION_FEES, 
            RESP_RL_HOME_SERVANTS, RESP_RL_FEES_ON_EXPATS, RESP_RL_OTHER_FUTURE_EXPENSES, RESP_RL_OTHER_INCOME, RESP_RL_TOTAL_EXPENSES, RESP_RL_OTHER_OBLIGATIONS, 
            ARMS_ARMS_MITIGANT_CODE, ARMS_ARMS_MITIGANT_DESC, ARMS_ARMS_MITIGANT_VALUE, ARMS_ARMS_COLL_AREA, ARMS_ARMS_VEHICLE_BRAND_NAME, 
            ARMS_ARMS_VEHICLE_BRAND_TYPE, ARMS_ARMS_PROP_EVAL_STATUS, ARMS_ARMS_MITIGANT_VAL_OWNER, ARMS_ARMS_BOOK_VALUE, ARMS_ARMS_VALUATION_DIFF, 
            ARMS_ARMS_CONTRACT_NUMBER, ARMS_ARMS_MANUFACTURE_YEAR, ARMS_ARMS_VEHI_MANUFACT_YEAR, ARMS_ARMS_REGION, ARMS_ARMS_PROPERTY_TYPE, SIMAH_TOTAL_LIABILITIES, 
            SIMAH_NO_OF_LOANS, SIMAH_TOTAL_LIMIT, SIMAH_TOTAL_REVOLVING_LIMIT, SIMAH_TOTAL_REVOLVING_LIAB, SIMAH_NO_OF_ENQUIRIES_12M, SIMAH_NO_OF_ENQUIRIES_30D, 
            SIMAH_NO_OF_BOUNCED_CHEQUE, SIMAH_SIMAH_SCORE, SIMAH_SIMAH_SCORE_VERSION, SIMAH_WORST_DELINQ_24M_CRC, SIMAH_WORST_DELINQ_24M_PLN, SIMAH_WORST_DELINQ_24M_AUTO, 
            SIMAH_WORST_DELINQ_24M_MTG, SIMAH_WORST_DELINQ_24M_OTHER, SIMAH_CUR_WORST_DELINQ_CRC, SIMAH_CUR_WORST_DELINQ_PLN, SIMAH_CUR_WORST_DELINQ_AUTO, 
            SIMAH_CUR_WORST_DELINQ_MTG, SIMAH_CUR_WORST_DELINQ_OTHER, SIMAH_CONTRACTUAL_PAY_CRC, SIMAH_CONTRACTUAL_PAY_PLN, SIMAH_CONTRACTUAL_PAY_AUTO, 
            SIMAH_CONTRACTUAL_PAY_MTG, SIMAH_CONTRACTUAL_PAY_OTHER, SIMAH_NO_OF_DEFAULT_CRC, SIMAH_NO_OF_DEFAULT_PLN, SIMAH_NO_OF_DEFAULT_AUTO, SIMAH_NO_OF_DEFAULT_MTG, 
            SIMAH_NO_OF_DEFAULT_OTHER, SIMAH_NO_OF_CI_DEFAULT_CRC, SIMAH_NO_OF_CI_DEFAULT_PLN, SIMAH_NO_OF_CI_DEFAULT_AUTO, SIMAH_NO_OF_CI_DEFAULT_MTG, 
            SIMAH_NO_OF_CI_DEFAULT_OTHER, SIMAH_SUMMED_SALARY, SIMAH_DEBT_BURDEN, SIMAH_DEBT_BURDEN_RATIO, SIMAH_NO_OF_EXECUTED_EXJUDG, SIMAH_NO_OF_NOTEXEC_EXJUDG, 
            SIMAH_OUTSTAND_BAL_NOTEXJUDG, CONT_PRINCIPAL_OUTSTANDING, CONT_OUTSTANDING_ACCRUVAL_PFT, CONT_OUTSTANDING_TOTAL_PFT, CONT_SUB_CODE, CASA_AVERAGE_BAL_MONTH_M0, 
            CASA_AVERAGE_BAL_MONTH_M1, CASA_AVERAGE_BAL_MONTH_M2, CASA_AVERAGE_BAL_MONTH_M3, CASA_AVERAGE_BAL_MONTH_M4, CASA_AVERAGE_BAL_MONTH_M5, CASA_AVERAGE_BAL_MONTH_M6, 
            CASA_AVERAGE_BAL_MONTH_M7, CASA_AVERAGE_BAL_MONTH_M8, CASA_AVERAGE_BAL_MONTH_M9, CASA_AVERAGE_BAL_MONTH_M10, CASA_AVERAGE_BAL_MONTH_M11, CARD_BRANCH_SHOWROOM_ACC, 
            SIMAH_CARD_PRODUCT_LIMIT, SIMAH_CARD_PRODUCT_CODE, SIMAH_CARD_OUTSTANDING_BAL, CARD_PRIMARY_CARD_FLG, CARD_SUPPLEMENTARY_CARD_LIMIT, SCOR_SCORING_REQUEST_TYPE, 
            SCOR_SCORING_STAGE, SCOR_SCORING_SOURCE, SCOR_APPEND_DB_CODE, SCOR_APPLICATION_ID, SCOR_NATIONAL_ID, SCOR_DB_TABLE_CODE, SCOR_TRANSACTION_ID, SCOR_CODE_01, 
            SCOR_CODE_02, SCOR_CODE_03, SCOR_CODE_04, SCOR_CODE_05, SCOR_CODE_06, SCOR_CODE_07, SCOR_CODE_08, SCOR_CODE_09, SCOR_CODE_10, SCOR_PROGRESS_NUMBER, 
            CUST_CIC_OPEN_DATE, CONT_TRANSACTION_DATE
FROM        A_SCORE_REQUEST_HIST            
WHERE       UPPER(PROCESS_STATUS) = 'PROCEED'
ORDER BY    RUN_ID DESC, REQUEST_ID DESC;

--      REPORT 6 -- B_SCORE_REQUEST_HIST records for execution and run dates.
CREATE OR REPLACE FORCE VIEW "B_SCORE_REQ_PROCESSED_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            RUN_ID, SCOR_PORTFOLIO_DATE, REQUEST_ID, PROCESS_STATUS, SCOR_CIC, PROD_PRODUCT_CODE, PROD_PRODUCT_TYPE, PROD_CUSTOMER_SEGMENT, PROD_SALARY_TRANSFER_TYPE, 
            PROD_SALARY_TRANSFER_TYPE_CTF, PROD_ADD_RATE, CUST_CIC_OPEN_DATE, CUST_CITY, CUST_CIVIL_STATUS, CUST_DATE_OF_BIRTH, CUST_DISTRICT_CODE, 
            CUST_EDUCATION_LEVEL, CUST_GENDER, CUST_HOUSE_OWNED_STATUS, CUST_LATEST_EMP_COMPANY, CUST_LATEST_EMP_DEPARTMENT, CUST_MARITAL_STATUS, CUST_NATIONALITY, 
            CUST_NUMBER_OF_CARS, CUST_OCCUPATION_TYPE, CUST_REGION, CUST_RESIDENT_STATUS, CUST_RESIDENT_TYPE, CUST_SALARY_TRANSFER_TYPE_CIF, CUST_TOT_NO_ACTIVE_CONTRACTS, 
            PROD_ARMS_BOOK_VALUE, PROD_ARMS_COLL_AREA, PROD_ARMS_CONTRACT_NUMBER, PROD_ARMS_MANUFACTURE_YEAR, PROD_ARMS_MITIGANT_CODE, PROD_ARMS_MITIGANT_DESC, 
            PROD_ARMS_MITIGANT_VALUE, PROD_ARMS_MITIGANT_VAL_OWNER, PROD_ARMS_PROPERTY_TYPE, PROD_ARMS_PROP_EVAL_STATUS, PROD_ARMS_REGION, PROD_ARMS_VALUATION_DIFF, 
            PROD_ARMS_VEHICLE_BRAND_CAT, PROD_ARMS_VEHICLE_BRAND_NAME, PROD_ARMS_VEHICLE_BRAND_TYPE, PROD_ARMS_VEHI_MANUFACT_YEAR, CASA_AVERAGE_BAL_MONTH_M0, 
            CASA_AVERAGE_BAL_MONTH_M1, CASA_AVERAGE_BAL_MONTH_M2, CASA_AVERAGE_BAL_MONTH_M3, CASA_AVERAGE_BAL_MONTH_M4, CASA_AVERAGE_BAL_MONTH_M5, CASA_AVERAGE_BAL_MONTH_M6, 
            CASA_AVERAGE_BAL_MONTH_M7, CASA_AVERAGE_BAL_MONTH_M8, CASA_AVERAGE_BAL_MONTH_M9, CASA_AVERAGE_BAL_MONTH_M10, CASA_AVERAGE_BAL_MONTH_M11, CASA_AVERAGE_BAL_MONTH_M12, 
            CASA_AVERAGE_BAL_MONTH_M13, CASA_AVERAGE_BAL_MONTH_M14, CASA_AVERAGE_BAL_MONTH_M15, CASA_AVERAGE_BAL_MONTH_M16, CASA_AVERAGE_BAL_MONTH_M17, 
            CASA_AVERAGE_BAL_MONTH_M18, CASA_AVERAGE_BAL_MONTH_M19, CASA_AVERAGE_BAL_MONTH_M20, CASA_AVERAGE_BAL_MONTH_M21, CASA_AVERAGE_BAL_MONTH_M22, 
            CASA_AVERAGE_BAL_MONTH_M23, CASA_AVERAGE_BAL_MONTH_M24, PROD_DELINQ_AMOUNT_M0, PROD_DELINQ_AMOUNT_M1, PROD_DELINQ_AMOUNT_M2, PROD_DELINQ_AMOUNT_M3, 
            PROD_DELINQ_AMOUNT_M4, PROD_DELINQ_AMOUNT_M5, PROD_DELINQ_AMOUNT_M6, PROD_DELINQ_AMOUNT_M7, PROD_DELINQ_AMOUNT_M8, PROD_DELINQ_AMOUNT_M9, PROD_DELINQ_AMOUNT_M10, 
            PROD_DELINQ_AMOUNT_M11, PROD_DELINQ_AMOUNT_M12, PROD_DELINQ_AMOUNT_M13, PROD_DELINQ_AMOUNT_M14, PROD_DELINQ_AMOUNT_M15, PROD_DELINQ_AMOUNT_M16, 
            PROD_DELINQ_AMOUNT_M17, PROD_DELINQ_AMOUNT_M18, PROD_DELINQ_AMOUNT_M19, PROD_DELINQ_AMOUNT_M20, PROD_DELINQ_AMOUNT_M21, PROD_DELINQ_AMOUNT_M22, 
            PROD_DELINQ_AMOUNT_M23, PROD_DELINQ_AMOUNT_M24, PROD_DELINQ_DAYS_M0, PROD_DELINQ_DAYS_M1, PROD_DELINQ_DAYS_M2, PROD_DELINQ_DAYS_M3, PROD_DELINQ_DAYS_M4, 
            PROD_DELINQ_DAYS_M5, PROD_DELINQ_DAYS_M6, PROD_DELINQ_DAYS_M7, PROD_DELINQ_DAYS_M8, PROD_DELINQ_DAYS_M9, PROD_DELINQ_DAYS_M10, PROD_DELINQ_DAYS_M11, 
            PROD_DELINQ_DAYS_M12, PROD_DELINQ_DAYS_M13, PROD_DELINQ_DAYS_M14, PROD_DELINQ_DAYS_M15, PROD_DELINQ_DAYS_M16, PROD_DELINQ_DAYS_M17, PROD_DELINQ_DAYS_M18, 
            PROD_DELINQ_DAYS_M19, PROD_DELINQ_DAYS_M20, PROD_DELINQ_DAYS_M21, PROD_DELINQ_DAYS_M22, PROD_DELINQ_DAYS_M23, PROD_DELINQ_DAYS_M24, PROD_EMI_M0, PROD_EMI_M1, 
            PROD_EMI_M2, PROD_EMI_M3, PROD_EMI_M4, PROD_EMI_M5, PROD_EMI_M6, PROD_EMI_M7, PROD_EMI_M8, PROD_EMI_M9, PROD_EMI_M10, PROD_EMI_M11, PROD_EMI_M12, PROD_EMI_M13, 
            PROD_EMI_M14, PROD_EMI_M15, PROD_EMI_M16, PROD_EMI_M17, PROD_EMI_M18, PROD_EMI_M19, PROD_EMI_M20, PROD_EMI_M21, PROD_EMI_M22, PROD_EMI_M23, PROD_EMI_M24, 
            PROD_OUTSTANDING_AMOUNT_M0, PROD_OUTSTANDING_AMOUNT_M1, PROD_OUTSTANDING_AMOUNT_M2, PROD_OUTSTANDING_AMOUNT_M3, PROD_OUTSTANDING_AMOUNT_M4, 
            PROD_OUTSTANDING_AMOUNT_M5, PROD_OUTSTANDING_AMOUNT_M6, PROD_OUTSTANDING_AMOUNT_M7, PROD_OUTSTANDING_AMOUNT_M8, PROD_OUTSTANDING_AMOUNT_M9, 
            PROD_OUTSTANDING_AMOUNT_M10, PROD_OUTSTANDING_AMOUNT_M11, PROD_OUTSTANDING_AMOUNT_M12, PROD_OUTSTANDING_AMOUNT_M13, PROD_OUTSTANDING_AMOUNT_M14, 
            PROD_OUTSTANDING_AMOUNT_M15, PROD_OUTSTANDING_AMOUNT_M16, PROD_OUTSTANDING_AMOUNT_M17, PROD_OUTSTANDING_AMOUNT_M18, PROD_OUTSTANDING_AMOUNT_M19, 
            PROD_OUTSTANDING_AMOUNT_M20, PROD_OUTSTANDING_AMOUNT_M21, PROD_OUTSTANDING_AMOUNT_M22, PROD_OUTSTANDING_AMOUNT_M23, PROD_OUTSTANDING_AMOUNT_M24, 
            PROD_ACCRUED_INT, PROD_BALLOON_AMOUNT, PROD_BASIC_SALARY_AMOUNT, PROD_BRANCH_SHOWROOM_ACC, PROD_BRANCH_SHOWROOM_ACC_CODE, PROD_BRANCH_SHOWROOM_CODE, 
            PROD_BUSINESS_POSITION, PROD_CHANNEL_CODE, PROD_CUR_BOOK_BAL, PROD_CURR_PAY, PROD_CURRENCY, PROD_CUS_SUBTYPE, PROD_DEBT_BURDEN_RATIO, PROD_DEPENDENTS, 
            PROD_DEPT_CODE, PROD_DISBURSEMENT_AMOUNT, PROD_DISBURSEMENT_DATE, PROD_DOWNPAYMENT_AMT, PROD_DURATION_IN_MONTH, PROD_EMP_COMPANY, PROD_EMP_DEPARTMENT, 
            PROD_EMPLOYEE_TYPE, PROD_EMPLOYER_CLASS_CODE, PROD_EMPLOYER_ENGAGEMENT_DATE, PROD_END_SERVICE_BENEFIT_AMT, PROD_FEES, PROD_FINANCE_AMT, PROD_FIRST_APPLICATION_DATE, 
            PROD_FIRST_APPROVAL_DATE, PROD_FIRST_OPEN_DATE, PROD_GROSS_SALARY, PROD_INSTAL_AMT, PROD_INSTAL_WITH_INSURANCE, PROD_LAST_APPLICATION_DATE, PROD_LAST_APPROVAL_DATE, 
            PROD_LAST_OPEN_DATE, PROD_LAST_PAYMENT_DATE, PROD_MATURE_DATE, PROD_MILITARY_RANK, PROD_MONTHLY_ALLOWANCE_AMT, PROD_MONTHLY_OTHER_INCOME_AMT, PROD_NET_BAL, 
            PROD_NEXT_PAY_DATE, PROD_NO_OF_DELINQ_INST, PROD_ORIG_APPROVAL_AMT, PROD_ORIG_BALANCE, PROD_ORIG_PAY, PROD_ORIG_PROFIT, PROD_OTH_MONTHLY_DEDUCT_AMT, 
            PROD_OUTSTANDING_ACCRUAL_PFT, PROD_OUTSTANDING_TOTAL_PFT, PROD_PAYMENT_PRINCIPAL_AMT, PROD_PROFIT_RATE_SUB_TYPE, PROD_RATE, PROD_RELATION_CONTRACT_TYPE, 
            PROD_REMAIN_PAYMENTS, PROD_REMAIN_TERM, PROD_SALES_BRANCH, PROD_SALES_CD, PROD_SALES_USERID, PROD_SUB_CODE, PROD_TERM, PROD_TOT_GRACE_PRD_PROFIT, 
            PROD_TOTAL_PAYMENTS, PROD_TOTAL_EARLY_PAYMENT_AMT, PROD_TOTAL_INSTALL_DUE_AMT, PROD_TOTAL_NO_OPEN_CONTRACTS, RESP_RL_COMMUNICATIONS, RESP_RL_EDUCATION_FEES, 
            RESP_RL_FEES_ON_EXPATS, RESP_RL_FOOD_BEVERAGES, RESP_RL_HEALTHCARE, RESP_RL_HOME_SERVANTS, RESP_RL_HOUSING, RESP_RL_OTHER_FUTURE_EXPENSES, RESP_RL_OTHER_INCOME, 
            RESP_RL_OTHER_OBLIGATIONS, RESP_RL_TOTAL_EXPENSES, RESP_RL_TRANSPORT, RESP_RL_UTILITIES, SCOR_CODE_01, SCOR_CODE_02, SCOR_CODE_03, SCOR_CODE_04, SCOR_CODE_05, 
            SCOR_CODE_06, SCOR_CODE_07, SCOR_CODE_08, SCOR_CODE_09, SCOR_CODE_10, SCOR_NATIONAL_ID, SCOR_SCORING_REQUEST_TYPE, SCOR_SCORING_SOURCE, SCOR_TRANSACTION_ID, 
            SIMAH_CARD_OUTSTANDING_BAL, SIMAH_CARD_PRODUCT_CODE, SIMAH_CARD_PRODUCT_LIMIT, SIMAH_CONTRACTUAL_PAY_AUTO, SIMAH_CONTRACTUAL_PAY_CRC, SIMAH_CONTRACTUAL_PAY_MTG, 
            SIMAH_CONTRACTUAL_PAY_OTHER, SIMAH_CONTRACTUAL_PAY_PLN, SIMAH_CUR_WORST_DELINQ_AUTO, SIMAH_CUR_WORST_DELINQ_CRC, SIMAH_CUR_WORST_DELINQ_MTG, 
            SIMAH_CUR_WORST_DELINQ_OTHER, SIMAH_CUR_WORST_DELINQ_PLN, SIMAH_DEBT_BURDEN, SIMAH_DEBT_BURDEN_RATIO, SIMAH_NO_OF_BOUNCED_CHEQUE, SIMAH_NO_OF_ENQUIRIES_12M, 
            SIMAH_NO_OF_ENQUIRIES_30D, SIMAH_NO_OF_LOANS, SIMAH_NO_OF_CI_DEFAULT_AUTO, SIMAH_NO_OF_CI_DEFAULT_CRC, SIMAH_NO_OF_CI_DEFAULT_MTG, SIMAH_NO_OF_CI_DEFAULT_OTHER, 
            SIMAH_NO_OF_CI_DEFAULT_PLN, SIMAH_NO_OF_DEFAULT_AUTO, SIMAH_NO_OF_DEFAULT_CRC, SIMAH_NO_OF_DEFAULT_MTG, SIMAH_NO_OF_DEFAULT_OTHER, SIMAH_NO_OF_DEFAULT_PLN, 
            SIMAH_NO_OF_EXEC_EXJUDG, SIMAH_NO_OF_NOTEXEC_EXJUDG, SIMAH_OUTSTAND_BAL_NOTEXJUDG, SIMAH_SIMAH_SCORE, SIMAH_SIMAH_SCORE_VERSION, SIMAH_SUMMED_SALARY, 
            SIMAH_TOTAL_LIABILITIES, SIMAH_TOTAL_LIMIT, SIMAH_TOTAL_REVOLVING_LIAB, SIMAH_TOTAL_REVOLVING_LIMIT, SIMAH_WORST_DELINQ_24M_AUTO, SIMAH_WORST_DELINQ_24M_OTHER, 
            SIMAH_WORST_DELINQ_24M_PLN, SIMAH_WORST_DELINQ_24M_CRC, SIMAH_WORST_DELINQ_24M_MTG
FROM        B_SCORE_REQUEST_HIST            
WHERE       UPPER(PROCESS_STATUS) = 'PROCEED'
ORDER BY    RUN_ID DESC, REQUEST_ID DESC;

--      REPORT 7 -- A_SCORE_REQUEST_HIST and A_SCORE_RESPONSE records for execution and run dates.
CREATE OR REPLACE FORCE VIEW "A_SCORE_REQ_RESPONSE_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            A_REQ.RUN_ID, A_REQ.CONT_RUN_DATE, A_RES.SCOR_EXECUTION_DATE_TIME, A_REQ.REQUEST_ID, A_REQ.PROCESS_STATUS, A_REQ.CONT_CIC, A_REQ.CONT_CONTRACT_NUMBER, 
            A_REQ.CONT_PRODUCT_CODE, A_REQ.CONT_PRODUCT_TYPE, A_REQ.CONT_CUSTOMER_SEGMENT, A_REQ.CUST_SALARY_TRANSFER_TYPE_CIF, 
            A_REQ.CONT_SALARY_TRANSFER_TYPE_CTF, A_REQ.CONT_SALARY_TRANSFER_TYPE, A_REQ.CONT_ADD_RATE, A_REQ.CONT_ACCOUNT_ID, A_REQ.CONT_ACCRUED_INT, 
            A_REQ.CONT_APPLICATION_DATE, A_REQ.CONT_APPROVAL_DATE, A_REQ.CONT_BALLOON_AMOUNT, A_REQ.CONT_BASIC_SALARY_AMOUNT, A_REQ.CONT_BRANCH_LOAN_APPLIED, 
            A_REQ.CONT_BRANCH_SHOWROOM_ACC, A_REQ.CONT_BUSINESS_POSITION, A_REQ.CONT_CUR_BOOK_BAL, A_REQ.CONT_CURR_PAY, A_REQ.CONT_CURRENCY, A_REQ.CONT_CUS_SUBTYPE, 
            A_REQ.CONT_DEBT_BURDEN_RATIO, A_REQ.CONT_DELINQ_DAYS, A_REQ.CONT_DEPENDENTS, A_REQ.CONT_DEPT_CODE, A_REQ.CONT_DISBURSEMENT_DATE, 
            A_REQ.CONT_DISBURSEMENT_AMOUNT, A_REQ.CONT_DOWNPAYMENT_AMT, A_REQ.CONT_EMP_DEPARTMENT, A_REQ.CONT_EMP_COMPANY, A_REQ.CONT_EMPLOYER_ENGAGEMENT_DATE, 
            A_REQ.CONT_FEES, A_REQ.CONT_FINANCE_AMT, A_REQ.CONT_GROSS_SALARY, A_REQ.CONT_H_CATEGORY_PRODUCT, A_REQ.CONT_INSTAL_AMT, A_REQ.CONT_INSTAL_WITH_INSURANCE, 
            A_REQ.CONT_LAST_PAYMENT_DATE, A_REQ.CONT_MATURE_DATE, A_REQ.CONT_MILITARY_RANK, A_REQ.CONT_NET_BAL, A_REQ.CONT_NEXT_PAY_DATE, 
            A_REQ.CONT_NO_OF_DELINQ_INST, A_REQ.CONT_OPEN_DATE, A_REQ.CONT_ORG_UNIT, A_REQ.CONT_ORIG_APPROVAL_AMT, A_REQ.CONT_ORIG_BALANCE, A_REQ.CONT_ORIG_PAY, 
            A_REQ.CONT_ORIG_PROFIT, A_REQ.CONT_ORIG_TERM, A_REQ.CONT_PAY_FREQUENCY, A_REQ.CONT_PAYMENT_PRINCIPAL_AMT, A_REQ.CONT_PROFIT_RATE_SUB_TYPE, 
            A_REQ.CONT_RATE, A_REQ.CONT_TOTAL_PAYMENTS, A_REQ.CONT_REMAIN_PAYMENTS, A_REQ.CONT_REMAIN_TERM, A_REQ.CUST_RESIDENT_STATUS, A_REQ.CUST_RESIDENT_TYPE, 
            A_REQ.CONT_SALES_BRANCH, A_REQ.CONT_SALES_CD, A_REQ.CONT_SALES_USERID, A_REQ.CONT_TERM, A_REQ.CONT_TOT_GRACE_PRD_PROFIT, 
            A_REQ.CONT_TOTAL_EARLY_PAYMENT_AMT, A_REQ.CONT_TOTAL_INSTAL_DUE_AMT, A_REQ.CUST_GENDER, A_REQ.CUST_MARITAL_STATUS, A_REQ.CUST_DATE_OF_BIRTH, 
            A_REQ.CONT_BRANCH_SHOWROOM_ACC_CODE, A_REQ.CONT_BRANCH_SHOWROOM_CODE, A_REQ.CONT_CHANNEL_CODE, A_REQ.CUST_CITY, A_REQ.CUST_CIVIL_STATUS, 
            A_REQ.CUST_DISTRICT_CODE, A_REQ.CONT_DURATION_IN_MONTH, A_REQ.CUST_EDUCATION_LEVEL, A_REQ.CONT_EMPLOYEE_TYPE, A_REQ.CONT_EMPLOYER_CLASS_CODE, 
            A_REQ.CONT_END_SERVICE_BENEFIT_AMT, A_REQ.CUST_HOUSE_OWNED_STATUS, A_REQ.CONT_MONTHLY_ALLOWANCE_AMOUNT, A_REQ.CONT_MONTHLY_OTHER_INCOME_AMT, 
            A_REQ.CUST_NATIONALITY, A_REQ.CUST_NUMBER_OF_CARS, A_REQ.CUST_OCCUPATION_TYPE, A_REQ.CONT_OTHER_MONTHLY_DEDUCT_AMT, A_REQ.CUST_REGION, 
            A_REQ.CONT_RELATION_CONTRACT_TYPE, A_REQ.RESP_RL_FOOD_BEVERAGES, A_REQ.RESP_RL_HOUSING, A_REQ.RESP_RL_UTILITIES, A_REQ.RESP_RL_HEALTHCARE, 
            A_REQ.RESP_RL_TRANSPORT, A_REQ.RESP_RL_COMMUNICATIONS, A_REQ.RESP_RL_EDUCATION_FEES, A_REQ.RESP_RL_HOME_SERVANTS, A_REQ.RESP_RL_FEES_ON_EXPATS, 
            A_REQ.RESP_RL_OTHER_FUTURE_EXPENSES, A_REQ.RESP_RL_OTHER_INCOME, A_REQ.RESP_RL_TOTAL_EXPENSES, A_REQ.RESP_RL_OTHER_OBLIGATIONS, 
            A_REQ.ARMS_ARMS_MITIGANT_CODE, A_REQ.ARMS_ARMS_MITIGANT_DESC, A_REQ.ARMS_ARMS_MITIGANT_VALUE, A_REQ.ARMS_ARMS_COLL_AREA, A_REQ.ARMS_ARMS_VEHICLE_BRAND_NAME, 
            A_REQ.ARMS_ARMS_VEHICLE_BRAND_TYPE, A_REQ.ARMS_ARMS_PROP_EVAL_STATUS, A_REQ.ARMS_ARMS_MITIGANT_VAL_OWNER, A_REQ.ARMS_ARMS_BOOK_VALUE, 
            A_REQ.ARMS_ARMS_VALUATION_DIFF, A_REQ.ARMS_ARMS_CONTRACT_NUMBER, A_REQ.ARMS_ARMS_MANUFACTURE_YEAR, A_REQ.ARMS_ARMS_VEHI_MANUFACT_YEAR, 
            A_REQ.ARMS_ARMS_REGION, A_REQ.ARMS_ARMS_PROPERTY_TYPE, A_REQ.SIMAH_TOTAL_LIABILITIES, A_REQ.SIMAH_NO_OF_LOANS, A_REQ.SIMAH_TOTAL_LIMIT, 
            A_REQ.SIMAH_TOTAL_REVOLVING_LIMIT, A_REQ.SIMAH_TOTAL_REVOLVING_LIAB, A_REQ.SIMAH_NO_OF_ENQUIRIES_12M, A_REQ.SIMAH_NO_OF_ENQUIRIES_30D, 
            A_REQ.SIMAH_NO_OF_BOUNCED_CHEQUE, A_REQ.SIMAH_SIMAH_SCORE, A_REQ.SIMAH_SIMAH_SCORE_VERSION, A_REQ.SIMAH_WORST_DELINQ_24M_CRC, 
            A_REQ.SIMAH_WORST_DELINQ_24M_PLN, A_REQ.SIMAH_WORST_DELINQ_24M_AUTO, A_REQ.SIMAH_WORST_DELINQ_24M_MTG, A_REQ.SIMAH_WORST_DELINQ_24M_OTHER, 
            A_REQ.SIMAH_CUR_WORST_DELINQ_CRC, A_REQ.SIMAH_CUR_WORST_DELINQ_PLN, A_REQ.SIMAH_CUR_WORST_DELINQ_AUTO, A_REQ.SIMAH_CUR_WORST_DELINQ_MTG, 
            A_REQ.SIMAH_CUR_WORST_DELINQ_OTHER, A_REQ.SIMAH_CONTRACTUAL_PAY_CRC, A_REQ.SIMAH_CONTRACTUAL_PAY_PLN, A_REQ.SIMAH_CONTRACTUAL_PAY_AUTO, 
            A_REQ.SIMAH_CONTRACTUAL_PAY_MTG, A_REQ.SIMAH_CONTRACTUAL_PAY_OTHER, A_REQ.SIMAH_NO_OF_DEFAULT_CRC, A_REQ.SIMAH_NO_OF_DEFAULT_PLN, 
            A_REQ.SIMAH_NO_OF_DEFAULT_AUTO, A_REQ.SIMAH_NO_OF_DEFAULT_MTG, A_REQ.SIMAH_NO_OF_DEFAULT_OTHER, A_REQ.SIMAH_NO_OF_CI_DEFAULT_CRC, 
            A_REQ.SIMAH_NO_OF_CI_DEFAULT_PLN, A_REQ.SIMAH_NO_OF_CI_DEFAULT_AUTO, A_REQ.SIMAH_NO_OF_CI_DEFAULT_MTG, A_REQ.SIMAH_NO_OF_CI_DEFAULT_OTHER, 
            A_REQ.SIMAH_SUMMED_SALARY, A_REQ.SIMAH_DEBT_BURDEN, A_REQ.SIMAH_DEBT_BURDEN_RATIO, A_REQ.SIMAH_NO_OF_EXECUTED_EXJUDG, A_REQ.SIMAH_NO_OF_NOTEXEC_EXJUDG, 
            A_REQ.SIMAH_OUTSTAND_BAL_NOTEXJUDG, A_REQ.CONT_PRINCIPAL_OUTSTANDING, A_REQ.CONT_OUTSTANDING_ACCRUVAL_PFT, A_REQ.CONT_OUTSTANDING_TOTAL_PFT, 
            A_REQ.CONT_SUB_CODE, A_REQ.CASA_AVERAGE_BAL_MONTH_M0, A_REQ.CASA_AVERAGE_BAL_MONTH_M1, A_REQ.CASA_AVERAGE_BAL_MONTH_M2, A_REQ.CASA_AVERAGE_BAL_MONTH_M3, 
            A_REQ.CASA_AVERAGE_BAL_MONTH_M4, A_REQ.CASA_AVERAGE_BAL_MONTH_M5, A_REQ.CASA_AVERAGE_BAL_MONTH_M6, A_REQ.CASA_AVERAGE_BAL_MONTH_M7, 
            A_REQ.CASA_AVERAGE_BAL_MONTH_M8, A_REQ.CASA_AVERAGE_BAL_MONTH_M9, A_REQ.CASA_AVERAGE_BAL_MONTH_M10, A_REQ.CASA_AVERAGE_BAL_MONTH_M11, 
            A_REQ.CARD_BRANCH_SHOWROOM_ACC, A_REQ.SIMAH_CARD_PRODUCT_LIMIT, A_REQ.SIMAH_CARD_PRODUCT_CODE, A_REQ.SIMAH_CARD_OUTSTANDING_BAL, 
            A_REQ.CARD_PRIMARY_CARD_FLG, A_REQ.CARD_SUPPLEMENTARY_CARD_LIMIT, A_REQ.CUST_CIC_OPEN_DATE, A_REQ.CONT_TRANSACTION_DATE, 
            A_RES.RESPONSE_ID, A_RES.CONTRACT_NUMBER, A_RES.CIC, A_RES.SCORING_SEGMENT, A_RES.SCORING_RUN_DATE, 
            A_RES.SCOR_APPLICATION_ID, A_RES.SCOR_NATIONAL_ID, A_RES.SCOR_TRANSACTION_ID, A_RES.SCOR_SCORING_SOURCE, A_RES.SCOR_SCORING_STAGE, 
            A_RES.SCOR_SCORING_REQUEST_TYPE, A_RES.SCOR_DB_TABLE_CODE, A_RES.SCOR_APPEND_DB_CODE, A_RES.SCOR_CODE_01, 
            A_RES.SCOR_CODE_02, A_RES.SCOR_CODE_03, A_RES.SCOR_CODE_04, A_RES.SCOR_CODE_05, A_RES.SCOR_CODE_06, A_RES.SCOR_CODE_07, A_RES.SCOR_CODE_08, 
            A_RES.SCOR_CODE_09, A_RES.SCOR_CODE_10, A_RES.A_SCOR_SCORECARD_ID, A_RES.A_SCOR_SCORECARD_NAME, A_RES.A_SCOR_SCORE, A_RES.A_SCOR_VERSION_NUMBER, 
            A_RES.A_SCOR_VERSION_DATE, A_RES.A_SCOR_PD_ESTIMATE, A_RES.A_SCOR_PD_OFFSET, A_RES.A_SCOR_PD_FACTOR, A_RES.A_SCOR_RISK_PROFILE, A_RES.A_SCOR_RISK_RATING, 
            A_RES.A_SCOR_APPROVAL_DELEGATION, A_RES.A_SCOR_PRODUCT_FAMILY, A_RES.A_SCOR_ELEMENT_01, A_RES.A_SCOR_VALUEA_01, A_RES.A_SCOR_VALUEB_01, 
            A_RES.A_SCOR_OUTCOME_01, A_RES.A_SCOR_SCORE_VALUE_01, A_RES.A_SCOR_FIELD_01, A_RES.A_SCOR_ELEMENT_02, A_RES.A_SCOR_VALUEA_02, 
            A_RES.A_SCOR_VALUEB_02, A_RES.A_SCOR_OUTCOME_02, A_RES.A_SCOR_SCORE_VALUE_02, A_RES.A_SCOR_FIELD_02, A_RES.A_SCOR_ELEMENT_03, 
            A_RES.A_SCOR_VALUEA_03, A_RES.A_SCOR_VALUEB_03, A_RES.A_SCOR_OUTCOME_03, A_RES.A_SCOR_SCORE_VALUE_03, A_RES.A_SCOR_FIELD_03, 
            A_RES.A_SCOR_ELEMENT_04, A_RES.A_SCOR_VALUEA_04, A_RES.A_SCOR_VALUEB_04, A_RES.A_SCOR_OUTCOME_04, A_RES.A_SCOR_SCORE_VALUE_04, 
            A_RES.A_SCOR_FIELD_04, A_RES.A_SCOR_ELEMENT_05, A_RES.A_SCOR_VALUEA_05, A_RES.A_SCOR_VALUEB_05, A_RES.A_SCOR_OUTCOME_05, 
            A_RES.A_SCOR_SCORE_VALUE_05, A_RES.A_SCOR_FIELD_05, A_RES.A_SCOR_ELEMENT_06, A_RES.A_SCOR_VALUEA_06, A_RES.A_SCOR_VALUEB_06, 
            A_RES.A_SCOR_OUTCOME_06, A_RES.A_SCOR_SCORE_VALUE_06, A_RES.A_SCOR_FIELD_06, A_RES.A_SCOR_ELEMENT_07, A_RES.A_SCOR_VALUEA_07, 
            A_RES.A_SCOR_VALUEB_07, A_RES.A_SCOR_OUTCOME_07, A_RES.A_SCOR_SCORE_VALUE_07, A_RES.A_SCOR_FIELD_07, A_RES.A_SCOR_ELEMENT_08, 
            A_RES.A_SCOR_VALUEA_08, A_RES.A_SCOR_VALUEB_08, A_RES.A_SCOR_OUTCOME_08, A_RES.A_SCOR_SCORE_VALUE_08, A_RES.A_SCOR_FIELD_08, 
            A_RES.A_SCOR_ELEMENT_09, A_RES.A_SCOR_VALUEA_09, A_RES.A_SCOR_VALUEB_09, A_RES.A_SCOR_OUTCOME_09, A_RES.A_SCOR_SCORE_VALUE_09, 
            A_RES.A_SCOR_FIELD_09, A_RES.A_SCOR_ELEMENT_10, A_RES.A_SCOR_VALUEA_10, A_RES.A_SCOR_VALUEB_10, A_RES.A_SCOR_OUTCOME_10, 
            A_RES.A_SCOR_SCORE_VALUE_10, A_RES.A_SCOR_FIELD_10, A_RES.A_SCOR_ELEMENT_11, A_RES.A_SCOR_VALUEA_11, A_RES.A_SCOR_VALUEB_11, 
            A_RES.A_SCOR_OUTCOME_11, A_RES.A_SCOR_SCORE_VALUE_11, A_RES.A_SCOR_FIELD_11, A_RES.A_SCOR_ELEMENT_12, A_RES.A_SCOR_VALUEA_12, 
            A_RES.A_SCOR_VALUEB_12, A_RES.A_SCOR_OUTCOME_12, A_RES.A_SCOR_SCORE_VALUE_12, A_RES.A_SCOR_FIELD_12, A_RES.A_SCOR_ELEMENT_13, 
            A_RES.A_SCOR_VALUEA_13, A_RES.A_SCOR_VALUEB_13, A_RES.A_SCOR_OUTCOME_13, A_RES.A_SCOR_SCORE_VALUE_13, A_RES.A_SCOR_FIELD_13, 
            A_RES.A_SCOR_ELEMENT_14, A_RES.A_SCOR_VALUEA_14, A_RES.A_SCOR_VALUEB_14, A_RES.A_SCOR_OUTCOME_14, A_RES.A_SCOR_SCORE_VALUE_14, 
            A_RES.A_SCOR_FIELD_14, A_RES.A_SCOR_ELEMENT_15, A_RES.A_SCOR_VALUEA_15, A_RES.A_SCOR_VALUEB_15, A_RES.A_SCOR_OUTCOME_15, 
            A_RES.A_SCOR_SCORE_VALUE_15, A_RES.A_SCOR_FIELD_15, A_RES.A_SCOR_ELEMENT_16, A_RES.A_SCOR_VALUEA_16, A_RES.A_SCOR_VALUEB_16, 
            A_RES.A_SCOR_OUTCOME_16, A_RES.A_SCOR_SCORE_VALUE_16, A_RES.A_SCOR_FIELD_16, A_RES.A_SCOR_ELEMENT_17, A_RES.A_SCOR_VALUEA_17, 
            A_RES.A_SCOR_VALUEB_17, A_RES.A_SCOR_OUTCOME_17, A_RES.A_SCOR_SCORE_VALUE_17, A_RES.A_SCOR_FIELD_17, A_RES.A_SCOR_ELEMENT_18, 
            A_RES.A_SCOR_VALUEA_18, A_RES.A_SCOR_VALUEB_18, A_RES.A_SCOR_OUTCOME_18, A_RES.A_SCOR_SCORE_VALUE_18, A_RES.A_SCOR_FIELD_18, 
            A_RES.A_SCOR_ELEMENT_19, A_RES.A_SCOR_VALUEA_19, A_RES.A_SCOR_VALUEB_19, A_RES.A_SCOR_OUTCOME_19, A_RES.A_SCOR_SCORE_VALUE_19, 
            A_RES.A_SCOR_FIELD_19, A_RES.A_SCOR_ELEMENT_20, A_RES.A_SCOR_VALUEA_20, A_RES.A_SCOR_VALUEB_20, A_RES.A_SCOR_OUTCOME_20, 
            A_RES.A_SCOR_SCORE_VALUE_20, A_RES.A_SCOR_FIELD_20, A_RES.A_SCOR_SUM_SCORES, A_RES.UNIQUE_ID, A_RES.UNIQUE_GENERATED_ID, 
            A_RES.SCOR_DEPLOYMENT_DATE, A_RES.SCOR_DEPLOYMENT_VERSION, A_RES.SCOR_DEPLOYMENT_NOTES, A_RES.TEST_GRP_TEST_GROUP_SET_ID, 
            A_RES.TEST_GRP_TEST_GROUP_SET_NAME, A_RES.TEST_GRP_TEST_GROUP_ID, A_RES.TEST_GRP_TEST_GROUP_NAME, A_RES.TEST_GRP_RANDOM_NUMBER, 
            A_RES.COMP_TREE_LEAF_NODE_ID, A_RES.COMP_TREE_LEAF_NODE_NAME, A_RES.SCOR_PROGRESS_NUMBER,
            A_RES.SPARE_SPARE_01, A_RES.SPARE_SPARE_02, A_RES.SPARE_SPARE_03, A_RES.SPARE_SPARE_04, A_RES.SPARE_SPARE_05, A_RES.SPARE_SPARE_06, 
            A_RES.SPARE_SPARE_07, A_RES.SPARE_SPARE_08, A_RES.SPARE_SPARE_09, A_RES.SPARE_SPARE_10, A_RES.SPARE_SPARE_11, A_RES.SPARE_SPARE_12, 
            A_RES.SPARE_SPARE_13, A_RES.SPARE_SPARE_14, A_RES.SPARE_SPARE_15, A_RES.SPARE_SPARE_16, A_RES.SPARE_SPARE_17, A_RES.SPARE_SPARE_18, 
            A_RES.SPARE_SPARE_19, A_RES.SPARE_SPARE_20, A_RES.SPARE_SPARE_21, A_RES.SPARE_SPARE_22, A_RES.SPARE_SPARE_23, A_RES.SPARE_SPARE_24, 
            A_RES.SPARE_SPARE_25, A_RES.SPARE_SPARE_26, A_RES.SPARE_SPARE_27, A_RES.SPARE_SPARE_28, A_RES.SPARE_SPARE_29, A_RES.SPARE_SPARE_30, 
            A_RES.SPARE_SPARE_31, A_RES.SPARE_SPARE_32, A_RES.SPARE_SPARE_33, A_RES.SPARE_SPARE_34, A_RES.SPARE_SPARE_35, A_RES.SPARE_SPARE_36, 
            A_RES.SPARE_SPARE_37, A_RES.SPARE_SPARE_38, A_RES.SPARE_SPARE_39, A_RES.SPARE_SPARE_40, A_RES.SPARE_SPARE_41, A_RES.SPARE_SPARE_42, 
            A_RES.SPARE_SPARE_43, A_RES.SPARE_SPARE_44, A_RES.SPARE_SPARE_45, A_RES.SPARE_SPARE_46, A_RES.SPARE_SPARE_47, A_RES.SPARE_SPARE_48, 
            A_RES.SPARE_SPARE_49, A_RES.SPARE_SPARE_50            
FROM        A_SCORE_REQUEST_HIST A_REQ, A_SCORE_RESPONSE A_RES            
WHERE       A_REQ.REQUEST_ID = A_RES.REQUEST_ID
AND         A_REQ.CONT_RUN_DATE = TO_DATE(A_RES.SCORING_RUN_DATE, 'YYYYMMDD')
ORDER BY    A_REQ.RUN_ID DESC, A_REQ.REQUEST_ID DESC;

--      REPORT 8 -- B_SCORE_REQUEST_HIST and B_SCORE_RESPONSE records for execution and run dates.
CREATE OR REPLACE FORCE VIEW "B_SCORE_REQ_RESPONSE_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            B_REQ.RUN_ID, B_REQ.SCOR_PORTFOLIO_DATE, B_RES.SCOR_EXECUTION_DATE_TIME, B_REQ.REQUEST_ID, B_REQ.PROCESS_STATUS, B_REQ.SCOR_CIC, B_REQ.PROD_PRODUCT_CODE, 
            B_REQ.PROD_PRODUCT_TYPE, B_REQ.PROD_CUSTOMER_SEGMENT, B_REQ.PROD_SALARY_TRANSFER_TYPE, B_REQ.PROD_SALARY_TRANSFER_TYPE_CTF, B_REQ.PROD_ADD_RATE, 
            B_REQ.CUST_CIC_OPEN_DATE, B_REQ.CUST_CITY, B_REQ.CUST_CIVIL_STATUS, B_REQ.CUST_DATE_OF_BIRTH, B_REQ.CUST_DISTRICT_CODE, B_REQ.CUST_EDUCATION_LEVEL, 
            B_REQ.CUST_GENDER, B_REQ.CUST_HOUSE_OWNED_STATUS, B_REQ.CUST_LATEST_EMP_COMPANY, B_REQ.CUST_LATEST_EMP_DEPARTMENT, B_REQ.CUST_MARITAL_STATUS, 
            B_REQ.CUST_NATIONALITY, B_REQ.CUST_NUMBER_OF_CARS, B_REQ.CUST_OCCUPATION_TYPE, B_REQ.CUST_REGION, B_REQ.CUST_RESIDENT_STATUS, B_REQ.CUST_RESIDENT_TYPE, 
            B_REQ.CUST_SALARY_TRANSFER_TYPE_CIF, B_REQ.CUST_TOT_NO_ACTIVE_CONTRACTS, B_REQ.PROD_ARMS_BOOK_VALUE, B_REQ.PROD_ARMS_COLL_AREA, 
            B_REQ.PROD_ARMS_CONTRACT_NUMBER, B_REQ.PROD_ARMS_MANUFACTURE_YEAR, B_REQ.PROD_ARMS_MITIGANT_CODE, B_REQ.PROD_ARMS_MITIGANT_DESC,
            B_REQ.PROD_ARMS_MITIGANT_VALUE, B_REQ.PROD_ARMS_MITIGANT_VAL_OWNER, B_REQ.PROD_ARMS_PROPERTY_TYPE, B_REQ.PROD_ARMS_PROP_EVAL_STATUS, 
            B_REQ.PROD_ARMS_REGION, B_REQ.PROD_ARMS_VALUATION_DIFF, B_REQ.PROD_ARMS_VEHICLE_BRAND_CAT, B_REQ.PROD_ARMS_VEHICLE_BRAND_NAME, 
            B_REQ.PROD_ARMS_VEHICLE_BRAND_TYPE, B_REQ.PROD_ARMS_VEHI_MANUFACT_YEAR, B_REQ.CASA_AVERAGE_BAL_MONTH_M0, B_REQ.CASA_AVERAGE_BAL_MONTH_M1, 
            B_REQ.CASA_AVERAGE_BAL_MONTH_M2, B_REQ.CASA_AVERAGE_BAL_MONTH_M3, B_REQ.CASA_AVERAGE_BAL_MONTH_M4, B_REQ.CASA_AVERAGE_BAL_MONTH_M5, 
            B_REQ.CASA_AVERAGE_BAL_MONTH_M6, B_REQ.CASA_AVERAGE_BAL_MONTH_M7, B_REQ.CASA_AVERAGE_BAL_MONTH_M8, B_REQ.CASA_AVERAGE_BAL_MONTH_M9, 
            B_REQ.CASA_AVERAGE_BAL_MONTH_M10, B_REQ.CASA_AVERAGE_BAL_MONTH_M11, B_REQ.CASA_AVERAGE_BAL_MONTH_M12, B_REQ.CASA_AVERAGE_BAL_MONTH_M13, 
            B_REQ.CASA_AVERAGE_BAL_MONTH_M14, B_REQ.CASA_AVERAGE_BAL_MONTH_M15, B_REQ.CASA_AVERAGE_BAL_MONTH_M16, B_REQ.CASA_AVERAGE_BAL_MONTH_M17,
            B_REQ.CASA_AVERAGE_BAL_MONTH_M18, B_REQ.CASA_AVERAGE_BAL_MONTH_M19, B_REQ.CASA_AVERAGE_BAL_MONTH_M20, B_REQ.CASA_AVERAGE_BAL_MONTH_M21, 
            B_REQ.CASA_AVERAGE_BAL_MONTH_M22, B_REQ.CASA_AVERAGE_BAL_MONTH_M23, B_REQ.CASA_AVERAGE_BAL_MONTH_M24, B_REQ.PROD_DELINQ_AMOUNT_M0, 
            B_REQ.PROD_DELINQ_AMOUNT_M1, B_REQ.PROD_DELINQ_AMOUNT_M2, B_REQ.PROD_DELINQ_AMOUNT_M3, B_REQ.PROD_DELINQ_AMOUNT_M4, B_REQ.PROD_DELINQ_AMOUNT_M5, 
            B_REQ.PROD_DELINQ_AMOUNT_M6, B_REQ.PROD_DELINQ_AMOUNT_M7, B_REQ.PROD_DELINQ_AMOUNT_M8, B_REQ.PROD_DELINQ_AMOUNT_M9, B_REQ.PROD_DELINQ_AMOUNT_M10,
            B_REQ.PROD_DELINQ_AMOUNT_M11, B_REQ.PROD_DELINQ_AMOUNT_M12, B_REQ.PROD_DELINQ_AMOUNT_M13, B_REQ.PROD_DELINQ_AMOUNT_M14, B_REQ.PROD_DELINQ_AMOUNT_M15, 
            B_REQ.PROD_DELINQ_AMOUNT_M16, B_REQ.PROD_DELINQ_AMOUNT_M17, B_REQ.PROD_DELINQ_AMOUNT_M18, B_REQ.PROD_DELINQ_AMOUNT_M19, B_REQ.PROD_DELINQ_AMOUNT_M20, 
            B_REQ.PROD_DELINQ_AMOUNT_M21, B_REQ.PROD_DELINQ_AMOUNT_M22, B_REQ.PROD_DELINQ_AMOUNT_M23, B_REQ.PROD_DELINQ_AMOUNT_M24, B_REQ.PROD_DELINQ_DAYS_M0, 
            B_REQ.PROD_DELINQ_DAYS_M1, B_REQ.PROD_DELINQ_DAYS_M2, B_REQ.PROD_DELINQ_DAYS_M3, B_REQ.PROD_DELINQ_DAYS_M4, B_REQ.PROD_DELINQ_DAYS_M5, 
            B_REQ.PROD_DELINQ_DAYS_M6, B_REQ.PROD_DELINQ_DAYS_M7, B_REQ.PROD_DELINQ_DAYS_M8, B_REQ.PROD_DELINQ_DAYS_M9, B_REQ.PROD_DELINQ_DAYS_M10, 
            B_REQ.PROD_DELINQ_DAYS_M11, B_REQ.PROD_DELINQ_DAYS_M12, B_REQ.PROD_DELINQ_DAYS_M13, B_REQ.PROD_DELINQ_DAYS_M14, B_REQ.PROD_DELINQ_DAYS_M15, 
            B_REQ.PROD_DELINQ_DAYS_M16, B_REQ.PROD_DELINQ_DAYS_M17, B_REQ.PROD_DELINQ_DAYS_M18, B_REQ.PROD_DELINQ_DAYS_M19, B_REQ.PROD_DELINQ_DAYS_M20, 
            B_REQ.PROD_DELINQ_DAYS_M21, B_REQ.PROD_DELINQ_DAYS_M22, B_REQ.PROD_DELINQ_DAYS_M23, B_REQ.PROD_DELINQ_DAYS_M24, B_REQ.PROD_EMI_M0, B_REQ.PROD_EMI_M1,
            B_REQ.PROD_EMI_M2, B_REQ.PROD_EMI_M3, B_REQ.PROD_EMI_M4, B_REQ.PROD_EMI_M5, B_REQ.PROD_EMI_M6, B_REQ.PROD_EMI_M7, B_REQ.PROD_EMI_M8, B_REQ.PROD_EMI_M9, 
            B_REQ.PROD_EMI_M10, B_REQ.PROD_EMI_M11, B_REQ.PROD_EMI_M12, B_REQ.PROD_EMI_M13, B_REQ.PROD_EMI_M14, B_REQ.PROD_EMI_M15, B_REQ.PROD_EMI_M16, 
            B_REQ.PROD_EMI_M17, B_REQ.PROD_EMI_M18, B_REQ.PROD_EMI_M19, B_REQ.PROD_EMI_M20, B_REQ.PROD_EMI_M21, B_REQ.PROD_EMI_M22, B_REQ.PROD_EMI_M23, 
            B_REQ.PROD_EMI_M24, B_REQ.PROD_OUTSTANDING_AMOUNT_M0, B_REQ.PROD_OUTSTANDING_AMOUNT_M1, B_REQ.PROD_OUTSTANDING_AMOUNT_M2, 
            B_REQ.PROD_OUTSTANDING_AMOUNT_M3, B_REQ.PROD_OUTSTANDING_AMOUNT_M4, B_REQ.PROD_OUTSTANDING_AMOUNT_M5, B_REQ.PROD_OUTSTANDING_AMOUNT_M6, 
            B_REQ.PROD_OUTSTANDING_AMOUNT_M7, B_REQ.PROD_OUTSTANDING_AMOUNT_M8, B_REQ.PROD_OUTSTANDING_AMOUNT_M9, B_REQ.PROD_OUTSTANDING_AMOUNT_M10, 
            B_REQ.PROD_OUTSTANDING_AMOUNT_M11, B_REQ.PROD_OUTSTANDING_AMOUNT_M12, B_REQ.PROD_OUTSTANDING_AMOUNT_M13, B_REQ.PROD_OUTSTANDING_AMOUNT_M14,
            B_REQ.PROD_OUTSTANDING_AMOUNT_M15, B_REQ.PROD_OUTSTANDING_AMOUNT_M16, B_REQ.PROD_OUTSTANDING_AMOUNT_M17, B_REQ.PROD_OUTSTANDING_AMOUNT_M18, 
            B_REQ.PROD_OUTSTANDING_AMOUNT_M19, B_REQ.PROD_OUTSTANDING_AMOUNT_M20, B_REQ.PROD_OUTSTANDING_AMOUNT_M21, B_REQ.PROD_OUTSTANDING_AMOUNT_M22, 
            B_REQ.PROD_OUTSTANDING_AMOUNT_M23, B_REQ.PROD_OUTSTANDING_AMOUNT_M24, B_REQ.PROD_ACCRUED_INT, B_REQ.PROD_BALLOON_AMOUNT, B_REQ.PROD_BASIC_SALARY_AMOUNT, 
            B_REQ.PROD_BRANCH_SHOWROOM_ACC, B_REQ.PROD_BRANCH_SHOWROOM_ACC_CODE, B_REQ.PROD_BRANCH_SHOWROOM_CODE, B_REQ.PROD_BUSINESS_POSITION, 
            B_REQ.PROD_CHANNEL_CODE, B_REQ.PROD_CUR_BOOK_BAL, B_REQ.PROD_CURR_PAY, B_REQ.PROD_CURRENCY, B_REQ.PROD_CUS_SUBTYPE, B_REQ.PROD_DEBT_BURDEN_RATIO, 
            B_REQ.PROD_DEPENDENTS, B_REQ.PROD_DEPT_CODE, B_REQ.PROD_DISBURSEMENT_AMOUNT, B_REQ.PROD_DISBURSEMENT_DATE, B_REQ.PROD_DOWNPAYMENT_AMT, 
            B_REQ.PROD_DURATION_IN_MONTH, B_REQ.PROD_EMP_COMPANY, B_REQ.PROD_EMP_DEPARTMENT, B_REQ.PROD_EMPLOYEE_TYPE, B_REQ.PROD_EMPLOYER_CLASS_CODE, 
            B_REQ.PROD_EMPLOYER_ENGAGEMENT_DATE, B_REQ.PROD_END_SERVICE_BENEFIT_AMT, B_REQ.PROD_FEES, B_REQ.PROD_FINANCE_AMT, B_REQ.PROD_FIRST_APPLICATION_DATE,
            B_REQ.PROD_FIRST_APPROVAL_DATE, B_REQ.PROD_FIRST_OPEN_DATE, B_REQ.PROD_GROSS_SALARY, B_REQ.PROD_INSTAL_AMT, B_REQ.PROD_INSTAL_WITH_INSURANCE, 
            B_REQ.PROD_LAST_APPLICATION_DATE, B_REQ.PROD_LAST_APPROVAL_DATE, B_REQ.PROD_LAST_OPEN_DATE, B_REQ.PROD_LAST_PAYMENT_DATE, B_REQ.PROD_MATURE_DATE, 
            B_REQ.PROD_MILITARY_RANK, B_REQ.PROD_MONTHLY_ALLOWANCE_AMT, B_REQ.PROD_MONTHLY_OTHER_INCOME_AMT, B_REQ.PROD_NET_BAL, B_REQ.PROD_NEXT_PAY_DATE, 
            B_REQ.PROD_NO_OF_DELINQ_INST, B_REQ.PROD_ORIG_APPROVAL_AMT, B_REQ.PROD_ORIG_BALANCE, B_REQ.PROD_ORIG_PAY, B_REQ.PROD_ORIG_PROFIT, 
            B_REQ.PROD_OTH_MONTHLY_DEDUCT_AMT, B_REQ.PROD_OUTSTANDING_ACCRUAL_PFT, B_REQ.PROD_OUTSTANDING_TOTAL_PFT, B_REQ.PROD_PAYMENT_PRINCIPAL_AMT, 
            B_REQ.PROD_PROFIT_RATE_SUB_TYPE, B_REQ.PROD_RATE, B_REQ.PROD_RELATION_CONTRACT_TYPE, B_REQ.PROD_REMAIN_PAYMENTS, B_REQ.PROD_REMAIN_TERM, 
            B_REQ.PROD_SALES_BRANCH, B_REQ.PROD_SALES_CD, B_REQ.PROD_SALES_USERID, B_REQ.PROD_SUB_CODE, B_REQ.PROD_TERM, B_REQ.PROD_TOT_GRACE_PRD_PROFIT,
            B_REQ.PROD_TOTAL_PAYMENTS, B_REQ.PROD_TOTAL_EARLY_PAYMENT_AMT, B_REQ.PROD_TOTAL_INSTALL_DUE_AMT, B_REQ.PROD_TOTAL_NO_OPEN_CONTRACTS, 
            B_REQ.RESP_RL_COMMUNICATIONS, B_REQ.RESP_RL_EDUCATION_FEES, B_REQ.RESP_RL_FEES_ON_EXPATS, B_REQ.RESP_RL_FOOD_BEVERAGES, B_REQ.RESP_RL_HEALTHCARE, 
            B_REQ.RESP_RL_HOME_SERVANTS, B_REQ.RESP_RL_HOUSING, B_REQ.RESP_RL_OTHER_FUTURE_EXPENSES, B_REQ.RESP_RL_OTHER_INCOME, B_REQ.RESP_RL_OTHER_OBLIGATIONS, 
            B_REQ.RESP_RL_TOTAL_EXPENSES, B_REQ.RESP_RL_TRANSPORT, B_REQ.RESP_RL_UTILITIES, B_REQ.SCOR_NATIONAL_ID, B_REQ.SIMAH_CARD_OUTSTANDING_BAL, 
            B_REQ.SIMAH_CARD_PRODUCT_CODE, B_REQ.SIMAH_CARD_PRODUCT_LIMIT, B_REQ.SIMAH_CONTRACTUAL_PAY_AUTO, B_REQ.SIMAH_CONTRACTUAL_PAY_CRC, 
            B_REQ.SIMAH_CONTRACTUAL_PAY_MTG, B_REQ.SIMAH_CONTRACTUAL_PAY_OTHER, B_REQ.SIMAH_CONTRACTUAL_PAY_PLN, B_REQ.SIMAH_CUR_WORST_DELINQ_AUTO, 
            B_REQ.SIMAH_CUR_WORST_DELINQ_CRC, B_REQ.SIMAH_CUR_WORST_DELINQ_MTG, B_REQ.SIMAH_CUR_WORST_DELINQ_OTHER, B_REQ.SIMAH_CUR_WORST_DELINQ_PLN, 
            B_REQ.SIMAH_DEBT_BURDEN, B_REQ.SIMAH_DEBT_BURDEN_RATIO, B_REQ.SIMAH_NO_OF_BOUNCED_CHEQUE, B_REQ.SIMAH_NO_OF_ENQUIRIES_12M, 
            B_REQ.SIMAH_NO_OF_ENQUIRIES_30D, B_REQ.SIMAH_NO_OF_LOANS, B_REQ.SIMAH_NO_OF_CI_DEFAULT_AUTO, B_REQ.SIMAH_NO_OF_CI_DEFAULT_CRC, 
            B_REQ.SIMAH_NO_OF_CI_DEFAULT_MTG, B_REQ.SIMAH_NO_OF_CI_DEFAULT_OTHER, B_REQ.SIMAH_NO_OF_CI_DEFAULT_PLN, B_REQ.SIMAH_NO_OF_DEFAULT_AUTO, 
            B_REQ.SIMAH_NO_OF_DEFAULT_CRC, B_REQ.SIMAH_NO_OF_DEFAULT_MTG, B_REQ.SIMAH_NO_OF_DEFAULT_OTHER, B_REQ.SIMAH_NO_OF_DEFAULT_PLN, 
            B_REQ.SIMAH_NO_OF_EXEC_EXJUDG, B_REQ.SIMAH_NO_OF_NOTEXEC_EXJUDG, B_REQ.SIMAH_OUTSTAND_BAL_NOTEXJUDG, B_REQ.SIMAH_SIMAH_SCORE, 
            B_REQ.SIMAH_SIMAH_SCORE_VERSION, B_REQ.SIMAH_SUMMED_SALARY, B_REQ.SIMAH_TOTAL_LIABILITIES, B_REQ.SIMAH_TOTAL_LIMIT, B_REQ.SIMAH_TOTAL_REVOLVING_LIAB, 
            B_REQ.SIMAH_TOTAL_REVOLVING_LIMIT, B_REQ.SIMAH_WORST_DELINQ_24M_AUTO, B_REQ.SIMAH_WORST_DELINQ_24M_OTHER, B_REQ.SIMAH_WORST_DELINQ_24M_PLN, 
            B_REQ.SIMAH_WORST_DELINQ_24M_CRC, B_REQ.SIMAH_WORST_DELINQ_24M_MTG,
            B_RES.RESPONSE_ID, B_RES.SCOR_CUSTOMER_SEGMENT, B_RES.SCOR_DEPLOYMENT_DATE, B_RES.SCOR_DEPLOYMENT_NOTES, 
            B_RES.SCOR_DEPLOYMENT_VERSION, B_RES.SCOR_PRODUCT_TYPE, B_RES.B_SCOR_SCORECARD_ID, B_RES.B_SCOR_SCORECARD_NAME, B_RES.B_SCOR_SCORING_SEGMENT, 
            B_RES.B_SCOR_VERSION_DATE, B_RES.B_SCOR_VERSION_NUMBER, B_RES.B_SCOR_PD_ESTIMATE, B_RES.B_SCOR_PD_FACTOR, B_RES.B_SCOR_PD_OFFSET, 
            B_RES.B_SCOR_RISK_PROFILE, B_RES.B_SCOR_RISK_RATING, B_RES.B_SCOR_PRODUCT_FAMILY, B_RES.B_SCOR_ELEMENT_01, B_RES.B_SCOR_VALUEA_01, 
            B_RES.B_SCOR_VALUEB_01, B_RES.B_SCOR_OUTCOME_01, B_RES.B_SCOR_SCORE_VALUE_01, B_RES.B_SCOR_FIELD_01, B_RES.B_SCOR_ELEMENT_02, B_RES.B_SCOR_VALUEA_02, 
            B_RES.B_SCOR_VALUEB_02, B_RES.B_SCOR_OUTCOME_02, B_RES.B_SCOR_SCORE_VALUE_02, B_RES.B_SCOR_FIELD_02, B_RES.B_SCOR_ELEMENT_03, B_RES.B_SCOR_VALUEA_03, 
            B_RES.B_SCOR_VALUEB_03, B_RES.B_SCOR_OUTCOME_03, B_RES.B_SCOR_SCORE_VALUE_03, B_RES.B_SCOR_FIELD_03, B_RES.B_SCOR_ELEMENT_04, 
            B_RES.B_SCOR_VALUEA_04, B_RES.B_SCOR_VALUEB_04, B_RES.B_SCOR_OUTCOME_04, B_RES.B_SCOR_SCORE_VALUE_04, B_RES.B_SCOR_FIELD_04, 
            B_RES.B_SCOR_ELEMENT_05, B_RES.B_SCOR_VALUEA_05, B_RES.B_SCOR_VALUEB_05, B_RES.B_SCOR_OUTCOME_05, B_RES.B_SCOR_SCORE_VALUE_05, 
            B_RES.B_SCOR_FIELD_05, B_RES.B_SCOR_ELEMENT_06, B_RES.B_SCOR_VALUEA_06, B_RES.B_SCOR_VALUEB_06, B_RES.B_SCOR_OUTCOME_06, 
            B_RES.B_SCOR_SCORE_VALUE_06, B_RES.B_SCOR_FIELD_06, B_RES.B_SCOR_ELEMENT_07, B_RES.B_SCOR_VALUEA_07, B_RES.B_SCOR_VALUEB_07, 
            B_RES.B_SCOR_OUTCOME_07, B_RES.B_SCOR_SCORE_VALUE_07, B_RES.B_SCOR_FIELD_07, B_RES.B_SCOR_ELEMENT_08, B_RES.B_SCOR_VALUEA_08, 
            B_RES.B_SCOR_VALUEB_08, B_RES.B_SCOR_OUTCOME_08, B_RES.B_SCOR_SCORE_VALUE_08, B_RES.B_SCOR_FIELD_08, B_RES.B_SCOR_ELEMENT_09, 
            B_RES.B_SCOR_VALUEA_09, B_RES.B_SCOR_VALUEB_09, B_RES.B_SCOR_OUTCOME_09, B_RES.B_SCOR_SCORE_VALUE_09, B_RES.B_SCOR_FIELD_09, 
            B_RES.B_SCOR_ELEMENT_10, B_RES.B_SCOR_VALUEA_10, B_RES.B_SCOR_VALUEB_10, B_RES.B_SCOR_OUTCOME_10, B_RES.B_SCOR_SCORE_VALUE_10, 
            B_RES.B_SCOR_FIELD_10, B_RES.B_SCOR_ELEMENT_11, B_RES.B_SCOR_VALUEA_11, B_RES.B_SCOR_VALUEB_11, B_RES.B_SCOR_OUTCOME_11, 
            B_RES.B_SCOR_SCORE_VALUE_11, B_RES.B_SCOR_FIELD_11, B_RES.B_SCOR_ELEMENT_12, B_RES.B_SCOR_VALUEA_12, B_RES.B_SCOR_VALUEB_12, 
            B_RES.B_SCOR_OUTCOME_12, B_RES.B_SCOR_SCORE_VALUE_12, B_RES.B_SCOR_FIELD_12, B_RES.B_SCOR_ELEMENT_13, B_RES.B_SCOR_VALUEA_13, 
            B_RES.B_SCOR_VALUEB_13, B_RES.B_SCOR_OUTCOME_13, B_RES.B_SCOR_SCORE_VALUE_13, B_RES.B_SCOR_FIELD_13, B_RES.B_SCOR_ELEMENT_14, 
            B_RES.B_SCOR_VALUEA_14, B_RES.B_SCOR_VALUEB_14, B_RES.B_SCOR_OUTCOME_14, B_RES.B_SCOR_SCORE_VALUE_14, B_RES.B_SCOR_FIELD_14, 
            B_RES.B_SCOR_ELEMENT_15, B_RES.B_SCOR_VALUEA_15, B_RES.B_SCOR_VALUEB_15, B_RES.B_SCOR_OUTCOME_15, B_RES.B_SCOR_SCORE_VALUE_15, 
            B_RES.B_SCOR_FIELD_15, B_RES.B_SCOR_ELEMENT_16, B_RES.B_SCOR_VALUEA_16, B_RES.B_SCOR_VALUEB_16, B_RES.B_SCOR_OUTCOME_16, 
            B_RES.B_SCOR_SCORE_VALUE_16, B_RES.B_SCOR_FIELD_16, B_RES.B_SCOR_ELEMENT_17, B_RES.B_SCOR_VALUEA_17, B_RES.B_SCOR_VALUEB_17, 
            B_RES.B_SCOR_OUTCOME_17, B_RES.B_SCOR_SCORE_VALUE_17, B_RES.B_SCOR_FIELD_17, B_RES.B_SCOR_ELEMENT_18, B_RES.B_SCOR_VALUEA_18, 
            B_RES.B_SCOR_VALUEB_18, B_RES.B_SCOR_OUTCOME_18, B_RES.B_SCOR_SCORE_VALUE_18, B_RES.B_SCOR_FIELD_18, B_RES.B_SCOR_ELEMENT_19, 
            B_RES.B_SCOR_VALUEA_19, B_RES.B_SCOR_VALUEB_19, B_RES.B_SCOR_OUTCOME_19, B_RES.B_SCOR_SCORE_VALUE_19, B_RES.B_SCOR_FIELD_19, 
            B_RES.B_SCOR_ELEMENT_20, B_RES.B_SCOR_VALUEA_20, B_RES.B_SCOR_VALUEB_20, B_RES.B_SCOR_OUTCOME_20, B_RES.B_SCOR_SCORE_VALUE_20, 
            B_RES.B_SCOR_FIELD_20, B_RES.B_SCOR_FINAL_SCORE_POINTS, B_RES.B_SCOR_INITIAL_SCORE_POINTS, B_RES.SCOR_CODE_01, B_RES.SCOR_CODE_02, 
            B_RES.SCOR_CODE_03, B_RES.SCOR_CODE_04, B_RES.SCOR_CODE_05, B_RES.SCOR_CODE_06, B_RES.SCOR_CODE_07, B_RES.SCOR_CODE_08, B_RES.SCOR_CODE_09, 
            B_RES.SCOR_CODE_10, B_RES.SCOR_SCORING_REQUEST_TYPE, B_RES.SCOR_SCORING_SOURCE, B_RES.SCOR_TRANSACTION_ID, B_RES.TEST_GRP_RANDOM_NUMBER, 
            B_RES.TEST_GRP_TEST_GROUP_ID, B_RES.TEST_GRP_TEST_GROUP_NAME, B_RES.TEST_GRP_TEST_GROUP_SET_ID, B_RES.TEST_GRP_TEST_GROUP_SET_NAME,
            B_RES.SPARE_SPARE_01, B_RES.SPARE_SPARE_02, B_RES.SPARE_SPARE_03, B_RES.SPARE_SPARE_04, B_RES.SPARE_SPARE_05, B_RES.SPARE_SPARE_06, 
            B_RES.SPARE_SPARE_07, B_RES.SPARE_SPARE_08, B_RES.SPARE_SPARE_09, B_RES.SPARE_SPARE_10, B_RES.SPARE_SPARE_11, B_RES.SPARE_SPARE_12, 
            B_RES.SPARE_SPARE_13, B_RES.SPARE_SPARE_14, B_RES.SPARE_SPARE_15, B_RES.SPARE_SPARE_16, B_RES.SPARE_SPARE_17, B_RES.SPARE_SPARE_18, 
            B_RES.SPARE_SPARE_19, B_RES.SPARE_SPARE_20, B_RES.SPARE_SPARE_21, B_RES.SPARE_SPARE_22, B_RES.SPARE_SPARE_23, B_RES.SPARE_SPARE_24, 
            B_RES.SPARE_SPARE_25, B_RES.SPARE_SPARE_26, B_RES.SPARE_SPARE_27, B_RES.SPARE_SPARE_28, B_RES.SPARE_SPARE_29, B_RES.SPARE_SPARE_30, 
            B_RES.SPARE_SPARE_31, B_RES.SPARE_SPARE_32, B_RES.SPARE_SPARE_33, B_RES.SPARE_SPARE_34, B_RES.SPARE_SPARE_35, B_RES.SPARE_SPARE_36, 
            B_RES.SPARE_SPARE_37, B_RES.SPARE_SPARE_38, B_RES.SPARE_SPARE_39, B_RES.SPARE_SPARE_40, B_RES.SPARE_SPARE_41, B_RES.SPARE_SPARE_42, 
            B_RES.SPARE_SPARE_43, B_RES.SPARE_SPARE_44, B_RES.SPARE_SPARE_45, B_RES.SPARE_SPARE_46, B_RES.SPARE_SPARE_47, B_RES.SPARE_SPARE_48, 
            B_RES.SPARE_SPARE_49, B_RES.SPARE_SPARE_50                                    
FROM        B_SCORE_REQUEST_HIST B_REQ, B_SCORE_RESPONSE B_RES
WHERE       B_REQ.REQUEST_ID = B_RES.REQUEST_ID
AND         B_REQ.SCOR_PORTFOLIO_DATE = B_RES.SCOR_PORTFOLIO_DATE
ORDER BY    B_REQ.RUN_ID DESC, B_REQ.REQUEST_ID DESC;

--      REPORT 9 -- Run log for ScoreExtraction_aScore for execution date.
CREATE OR REPLACE FORCE VIEW "A_SCORE_ERROR_LOG_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            LOG.REQUEST_ID, A_REQ.RUN_ID, A_REQ.CONT_CONTRACT_NUMBER, A_REQ.CONT_CIC,
            CASE WHEN LOG.LOG_USER = 'ScoreExtraction_aScore' THEN 'Contract'
                 WHEN LOG.LOG_USER = 'ScoreExtraction_bScore' THEN 'Customer' END AS LOG_TYPE, 
            LOG.RUN_STATUS, SUBSTR(LOG.LOG_RESULT,INSTR(LOG.LOG_RESULT,':',1,1)+2) AS LOG_RESULT, LOG.LOG_USER, LOG.LOG_DATE, LOG.LOG_ID
FROM        RUN_LOG LOG, A_SCORE_REQUEST_HIST A_REQ
WHERE       LOG.LOG_USER = 'ScoreExtraction_aScore'
AND         LOG.REQUEST_ID = A_REQ.REQUEST_ID
AND         LOG.RUN_STATUS = 'Error'
AND         LOG.LOG_RESULT LIKE '%Error%'
ORDER BY    DECODE(LOG.LOG_USER,'ScoreExtraction_aScore',1,'ScoreExtraction_bScore',2), 
            A_REQ.RUN_ID DESC, LOG.LOG_ID DESC;

--      REPORT 10 -- Run log for ScoreExtraction_bScore for execution date.
CREATE OR REPLACE FORCE VIEW "B_SCORE_ERROR_LOG_REPORT" AS 
SELECT      /*+ PARALLEL(8)*/
            LOG.REQUEST_ID, B_REQ.RUN_ID, B_REQ.SCOR_CIC,
            CASE WHEN LOG.LOG_USER = 'ScoreExtraction_aScore' THEN 'Contract'
                 WHEN LOG.LOG_USER = 'ScoreExtraction_bScore' THEN 'Customer' END AS LOG_TYPE, 
            LOG.RUN_STATUS, SUBSTR(LOG.LOG_RESULT,INSTR(LOG.LOG_RESULT,':',1,1)+2) AS LOG_RESULT, LOG.LOG_USER, LOG.LOG_DATE, LOG.LOG_ID
FROM        RUN_LOG LOG, B_SCORE_REQUEST_HIST B_REQ
WHERE       LOG.LOG_USER = 'ScoreExtraction_bScore'
AND         LOG.REQUEST_ID = B_REQ.REQUEST_ID
AND         LOG.RUN_STATUS = 'Error'
AND         LOG.LOG_RESULT LIKE '%Error%'
ORDER BY    DECODE(LOG.LOG_USER,'ScoreExtraction_aScore',1,'ScoreExtraction_bScore',2), 
            B_REQ.RUN_ID DESC, LOG.LOG_ID DESC;